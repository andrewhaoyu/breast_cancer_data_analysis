rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix <- correlation.matrix[c(1,2,4,5),c(1,2,4,5)]
library(corrplot)
corrplot(correlation.matrix, method = "circle")
pal.breaks <- seq(0.5,1,0.01)
col <- colorRampPalette(c("white","red"))(length(pal.breaks)-1)
correlation.matrix.icog <- correlation.matrix
corrplot.mixed(correlation.matrix)
corrplot.mixed(correlation.matrix,lower.col = "black", number.cex = .7)
corrplot.mixed(correlation.matrix,lower.col = "black", number.cex = .9)
corrplot.mixed(correlation.matrix,lower.col = "black", number.cex = 1)
corrplot.mixed(correlation.matrix,lower.col = "black", number.cex = 2)
correlation.matrix
corrplot(correlation.matrix, method = "circle")
corrplot(correlation.matrix, method = "circle",order="hclust")
corrplot(correlation.matrix, method = "circle",order="hclust",addrect=2)
corrplot(correlation.matrix, method = "color",order="hclust",addrect=2)
circle
corrplot(correlation.matrix, method = "circle",order="hclust",addrect=2)
corrplot(correlation.matrix, method = "circle",order="hclust",addrect=2,lower.col = "black", number.cex = 2)
corrplot(correlation.matrix, method = "circle",order="hclust",addrect=2, number.cex = 2)
corrplot(correlation.matrix, method = "circle",order="hclust",addrect=2,type = "upper")
corrplot(correlation.matrix, method = "circle",order="hclust",addrect=2,type = "upper",number.cex=2)
corrplot(correlation.matrix, method = "circle",order="hclust",addrect=2)
corrplot(correlation.matrix, method = "circle",order="hclust",addrect=2,pch.cex = 0.5)
corrplot(correlation.matrix, method = "circle",order="hclust",addrect=2,pch.cex = 0.5,insig = "label_sig")
# load("./breast_cancer_ldsc/ICOG_ldsc_result.rda")
# load("./breast_cancer_ldsc/ONCO_ldsc_result.rda")
#load("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/meta_ldsc_result.rda")
intrinsic_result <- read.csv("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/two_stage_model_genetic_correlation_result.csv",header=F)
intrinsic_result
correlation.matrix
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result')
# load("./breast_cancer_ldsc/ICOG_ldsc_result.rda")
# load("./breast_cancer_ldsc/ONCO_ldsc_result.rda")
#load("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/meta_ldsc_result.rda")
intrinsic_result <- read.csv("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/two_stage_model_genetic_correlation_result.csv",header=F)
correlation.matrix <- intrinsic_result[1:5,2:6]
correlation.matrix.se <- intrinsic_result[6:10,2:6]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
colnames(correlation.95) <- intrinsic_result[1:5,1]
rownames(correlation.95) <- intrinsic_result[1:5,1]
write.csv(correlation.95,file="./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/covariance_95_two_stage.csv",quote=F)
places <- 3
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
# correlation.matrix <- as.matrix(as.data.frame(fread("genetic_correlation_meta.csv")[,1:5]))
rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result')
# load("./breast_cancer_ldsc/ICOG_ldsc_result.rda")
# load("./breast_cancer_ldsc/ONCO_ldsc_result.rda")
#load("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/meta_ldsc_result.rda")
intrinsic_result <- read.csv("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/two_stage_model_genetic_correlation_result.csv",header=F)
correlation.matrix <- intrinsic_result[1:5,2:6]
correlation.matrix.se <- intrinsic_result[6:10,2:6]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
colnames(correlation.95) <- intrinsic_result[1:5,1]
rownames(correlation.95) <- intrinsic_result[1:5,1]
write.csv(correlation.95,file="./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/covariance_95_two_stage.csv",quote=F)
places <- 3
colnames(correlation.matrix) <- intrinsic_result[1:5,1]
rownames(correlation.matrix) <- intrinsic_result[1:5,1]
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
correlation.matrix
# correlation.matrix <- as.matrix(as.data.frame(fread("genetic_correlation_meta.csv")[,1:5]))
#rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix <- correlation.matrix[c(1,2,4,5),c(1,2,4,5)]
library(corrplot)
corrplot(correlation.matrix, method = "circle",order="hclust",)
corrplot(correlation.matrix, method = "circle",order="hclust",add=2)
corrplot(correlation.matrix, method = "circle",order="hclust",addrect=2)
correlation.matrix
corrplot(correlation.matrix, method = "circle")
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result')
# load("./breast_cancer_ldsc/ICOG_ldsc_result.rda")
# load("./breast_cancer_ldsc/ONCO_ldsc_result.rda")
#load("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/meta_ldsc_result.rda")
intrinsic_result <- read.csv("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/two_stage_model_genetic_correlation_result.csv",header=F)
correlation.matrix <- intrinsic_result[1:5,2:6]
correlation.matrix.se <- intrinsic_result[6:10,2:6]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
colnames(correlation.matrix) <- intrinsic_result[1:5,1]
rownames(correlation.matrix) <- intrinsic_result[1:5,1]
colnames(correlation.95) <- intrinsic_result[1:5,1]
rownames(correlation.95) <- intrinsic_result[1:5,1]
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
correlation.matrix
# correlation.matrix <- as.matrix(as.data.frame(fread("genetic_correlation_meta.csv")[,1:5]))
#rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix <- correlation.matrix[c(1,2,4,5),c(1,2,4,5)]
correlation.matrix
corrplot(correlation.matrix, method = "circle")
rownames(correlation.matrix) <- colnames(correlation.matrix)
corrplot(correlation.matrix, method = "circle")
class(correlation.matrix)
# correlation.matrix <- as.matrix(as.data.frame(fread("genetic_correlation_meta.csv")[,1:5]))
#rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix <- as.matrix(correlation.matrix[c(1,2,4,5),c(1,2,4,5)])
# correlation.matrix <- as.matrix(as.data.frame(fread("genetic_correlation_meta.csv")[,1:5]))
#rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix <- as.matrix(correlation.matrix[c(1,2,4,5),c(1,2,4,5)])
correlation.matrix <- as.matrix(correlation.matrix)
corrplot(correlation.matrix, method = "circle")
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2)
# load("./breast_cancer_ldsc/ICOG_ldsc_result.rda")
# load("./breast_cancer_ldsc/ONCO_ldsc_result.rda")
#load("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/meta_ldsc_result.rda")
intrinsic_result <- read.csv("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/two_stage_model_genetic_correlation_result.csv",header=F)
intrinsic_result
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result')
# load("./breast_cancer_ldsc/ICOG_ldsc_result.rda")
# load("./breast_cancer_ldsc/ONCO_ldsc_result.rda")
#load("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/meta_ldsc_result.rda")
intrinsic_result <- read.csv("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/two_stage_model_genetic_correlation_result.csv",header=F)
correlation.matrix <- intrinsic_result[1:5,2:6]
correlation.matrix.se <- intrinsic_result[6:10,2:6]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
colnames(correlation.matrix) <- intrinsic_result[1:5,1]
rownames(correlation.matrix) <- intrinsic_result[1:5,1]
colnames(correlation.95) <- intrinsic_result[1:5,1]
rownames(correlation.95) <- intrinsic_result[1:5,1]
write.csv(correlation.95,file="./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/covariance_95_two_stage.csv",quote=F)
places <- 3
correlation.matrix <- correlation.matrix[c(1,2,4,5),c(1,2,4,5)]
rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix <- as.matrix(correlation.matrix)
#correlation.matrix <- correlation.matrix[c(2,4,3,1),c(2,4,3,1)]
library(corrplot)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2)
col <- colorRampPalette(c("white","red"))(length(pal.breaks)-1)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2)
pal.breaks <- seq(0.5,1,0.01)
col <- colorRampPalette(c("white","red"))(length(pal.breaks)-1)
# heatmap(correlation.matrix,col = col,symm=T,margins=c(10,4),key.title="",key.ylab="",cexRow=1,cexCol=1)
png(filename="./meta_heatmap_two_stage.png",width=10,heigh=10,units="in",res=600)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2)
# heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
#           main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
dev.off()
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/two-stage-model-intrinsic_subtype/')
# load("./breast_cancer_ldsc/ICOG_ldsc_result.rda")
# load("./breast_cancer_ldsc/ONCO_ldsc_result.rda")
#load("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/meta_ldsc_result.rda")
intrinsic_result <- read.csv("two_stage_model_genetic_correlation_result.csv",header=F)
correlation.matrix <- intrinsic_result[1:5,2:6]
correlation.matrix.se <- intrinsic_result[6:10,2:6]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
colnames(correlation.matrix) <- intrinsic_result[1:5,1]
rownames(correlation.matrix) <- intrinsic_result[1:5,1]
colnames(correlation.95) <- intrinsic_result[1:5,1]
rownames(correlation.95) <- intrinsic_result[1:5,1]
write.csv(correlation.95,file="covariance_95_two_stage.csv",quote=F)
places <- 3
# covariance.matrix.new <- rep("c",25)
#
#
# covariance.matrix.transform <- log(covariance.matrix)
# covariance.matrix.transform.low <- covariance.matrix.transform - 1.96*covariance.matrix.se/covariance.matrix
# covariance.matrix.transform.high <- covariance.matrix.transform + 1.96*covariance.matrix.se/covariance.matrix
# covariance.matrix.high <- exp(covariance.matrix.transform.high)
# covariance.matrix.low  <- exp(covariance.matrix.transform.low)
# covariance.matrix.high <- round(covariance.matrix.high,places)
# covariance.matrix.low <- round(covariance.matrix.low,places)
#
# temp <- 1
# for(i in 1:5){
#   for(j in 1:5){
#     covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix.low[i,j],"-",covariance.matrix.high[i,j],")")
#     temp <- temp+1
#   }
# }
# covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
#covariance.matrix.icog <- covariance.matrix.new
# write.csv(covariance.matrix.icog,file="./covariance_matrix_icog.csv",quote=F)
# write.csv(correlation.matrix.new,file="./correlation_matrix_icog.csv",quote=F)
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
# correlation.matrix <- as.matrix(as.data.frame(fread("genetic_correlation_meta.csv")[,1:5]))
#rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix <- correlation.matrix[c(1,2,4,5),c(1,2,4,5)]
rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix <- as.matrix(correlation.matrix)
#correlation.matrix <- correlation.matrix[c(2,4,3,1),c(2,4,3,1)]
library(corrplot)
pal.breaks <- seq(0.5,1,0.01)
col <- colorRampPalette(c("white","red"))(length(pal.breaks)-1)
# heatmap(correlation.matrix,col = col,symm=T,margins=c(10,4),key.title="",key.ylab="",cexRow=1,cexCol=1)
png(filename="./meta_heatmap_two_stage.png",width=10,heigh=10,units="in",res=600)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2)
# heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
#           main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
dev.off()
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2, tl.col = "black")
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2, tl.col = "black", tl.srt = 45)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2, tl.col = "black", tl.srt = 35)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2, tl.col = "black", tl.srt = 25)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2, tl.col = "black", tl.srt = 0)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2, tl.col = "black", tl.srt = 10)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2, tl.col = "black", tl.srt = 30)
pal.breaks <- seq(0.5,1,0.01)
col <- colorRampPalette(c("white","red"))(length(pal.breaks)-1)
# heatmap(correlation.matrix,col = col,symm=T,margins=c(10,4),key.title="",key.ylab="",cexRow=1,cexCol=1)
png(filename="./meta_heatmap_two_stage.png",width=10,heigh=10,units="in",res=600)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2, tl.col = "black", tl.srt = 30)
# heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
#           main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
dev.off()
write.csv(correlation.95,file="covariance_95_two_stage.csv",quote=F)
ER_result <- read.csv("ER_genetic_correlation_result.csv",header=F)
ER_result <- read.csv("ER_genetic_correlation_result.csv",header=F)
ER_result <- fread("ER_genetic_correlation_result.csv",header=F)
ER_RESULT
ER_result
ER_result <- as.data.frame(fread("ER_genetic_correlation_result.csv",header=F))
correlation.matrix <- intrinsic_result[1:2,1:2]
correlation.matrix.se <- intrinsic_result[3:4,3:4]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.transform
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/two-stage-model-intrinsic_subtype/')
correlation.matrix
ER_result
ER_result <- as.data.frame(fread("ER_genetic_correlation_result.csv",header=F))
correlation.matrix <- ER_result[1:2,1:2]
correlation.matrix.se <- ER_result[3:4,3:4]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
correlation.95
0.6745+1.96*0.04
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.transform
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix <- round(correlation.matrix,places)
correlation.matrix.low <- round(correlation.matrix.low,places)
correlation.matrix.high <- round(correlation.matrix.high,places)
M <- nrow(correlation.matrix)
correlation.matrix.new <- rep("c",M^2)
temp <- 1
for(i in 1:M){
for(j in 1:M){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,5,5)
correlation.matrix.new <- matrix(correlation.matrix.new,M,M)
M <- nrow(correlation.matrix)
correlation.matrix.new <- rep("c",M^2)
temp <- 1
for(i in 1:M){
for(j in 1:M){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,M,M)
correlation.matrix.new
correlation.matrix.se.transform
correlation.matrix.se.transform
correlation.matrix.se
ER_result <- as.data.frame(fread("ER_genetic_correlation_result.csv",header=F))
correlation.matrix <- ER_result[1:2,1:2]
correlation.matrix.se <- ER_result[3:4,3:4]
ER_result
get_cor_95 <- function(correlation.matrix,correlation.matrix.se){
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix <- round(correlation.matrix,places)
correlation.matrix.low <- round(correlation.matrix.low,places)
correlation.matrix.high <- round(correlation.matrix.high,places)
M <- nrow(correlation.matrix)
correlation.matrix.new <- rep("c",M^2)
temp <- 1
for(i in 1:M){
for(j in 1:M){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,M,M)
return(correlation.matrix.new)
}
ER_result <- as.data.frame(fread("ER_genetic_correlation_result.csv",header=F))
correlation.matrix <- ER_result[1:2,1:2]
correlation.matrix.se <- ER_result[3:4,1:2]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
colnames(correlation.matrix) <- intrinsic_result[1:5,1]
rownames(correlation.matrix) <- intrinsic_result[1:5,1]
colnames(correlation.95) <- intrinsic_result[1:5,1]
rownames(correlation.95) <- intrinsic_result[1:5,1]
ER_result <- as.data.frame(fread("ER_genetic_correlation_result.csv",header=F))
correlation.matrix <- ER_result[1:2,1:2]
correlation.matrix.se <- ER_result[3:4,1:2]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
correlation.95
colnames(correlation.matrix) <- c("ER pos","ER neg")
rownames(correlation.matrix) <- c("ER pos","ER neg")
colnames(correlation.95) <- c("ER pos","ER neg")
rownames(correlation.95) <- c("ER pos","ER neg")
write.csv(correlation.95,file="covariance_95_ER.csv",quote=F)
Ò
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/two-stage-model-intrinsic_subtype/')
# load("./breast_cancer_ldsc/ICOG_ldsc_result.rda")
# load("./breast_cancer_ldsc/ONCO_ldsc_result.rda")
#load("./breast_cancer_ldsc/two-stage-model-intrinsic_subtype/meta_ldsc_result.rda")
intrinsic_result <- read.csv("two_stage_model_genetic_correlation_result.csv",header=F)
correlation.matrix <- intrinsic_result[1:5,2:6]
correlation.matrix.se <- intrinsic_result[6:10,2:6]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
colnames(correlation.matrix) <- intrinsic_result[1:5,1]
rownames(correlation.matrix) <- intrinsic_result[1:5,1]
colnames(correlation.95) <- intrinsic_result[1:5,1]
rownames(correlation.95) <- intrinsic_result[1:5,1]
write.csv(correlation.95,file="covariance_95_two_stage.csv",quote=F)
places <- 3
# covariance.matrix.new <- rep("c",25)
#
#
# covariance.matrix.transform <- log(covariance.matrix)
# covariance.matrix.transform.low <- covariance.matrix.transform - 1.96*covariance.matrix.se/covariance.matrix
# covariance.matrix.transform.high <- covariance.matrix.transform + 1.96*covariance.matrix.se/covariance.matrix
# covariance.matrix.high <- exp(covariance.matrix.transform.high)
# covariance.matrix.low  <- exp(covariance.matrix.transform.low)
# covariance.matrix.high <- round(covariance.matrix.high,places)
# covariance.matrix.low <- round(covariance.matrix.low,places)
#
# temp <- 1
# for(i in 1:5){
#   for(j in 1:5){
#     covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix.low[i,j],"-",covariance.matrix.high[i,j],")")
#     temp <- temp+1
#   }
# }
# covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
#covariance.matrix.icog <- covariance.matrix.new
# write.csv(covariance.matrix.icog,file="./covariance_matrix_icog.csv",quote=F)
# write.csv(correlation.matrix.new,file="./correlation_matrix_icog.csv",quote=F)
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
# correlation.matrix <- as.matrix(as.data.frame(fread("genetic_correlation_meta.csv")[,1:5]))
#rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix <- correlation.matrix[c(1,2,4,5),c(1,2,4,5)]
rownames(correlation.matrix) <- colnames(correlation.matrix)
correlation.matrix <- as.matrix(correlation.matrix)
#correlation.matrix <- correlation.matrix[c(2,4,3,1),c(2,4,3,1)]
library(corrplot)
pal.breaks <- seq(0.5,1,0.01)
col <- colorRampPalette(c("white","red"))(length(pal.breaks)-1)
# heatmap(correlation.matrix,col = col,symm=T,margins=c(10,4),key.title="",key.ylab="",cexRow=1,cexCol=1)
png(filename="./meta_heatmap_two_stage.png",width=10,heigh=10,units="in",res=600)
corrplot(correlation.matrix, method = "circle",order="hclust",
addrect=2, tl.col = "black", tl.srt = 30)
# heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
#           main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
dev.off()
ER_result <- as.data.frame(fread("ER_genetic_correlation_result.csv",header=F))
correlation.matrix <- ER_result[1:2,1:2]
correlation.matrix.se <- ER_result[3:4,1:2]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
colnames(correlation.matrix) <- c("ER pos","ER neg")
rownames(correlation.matrix) <- c("ER pos","ER neg")
colnames(correlation.95) <- c("ER pos","ER neg")
rownames(correlation.95) <- c("ER pos","ER neg")
write.csv(correlation.95,file="covariance_95_ER.csv",quote=F)
places <- 3
Ò
transfrom
get_cor_95
subtypes <- factor(subtypes,levels=c("Luminal A",
"Luminal B",
"Luminal B HER2Neg",
"HER2 Enriched",
"Triple Negative"))
library(data.table)
library(bc2)
#data <- fread("./data/dataset_montse_20180522.txt")
setwd('/spin1/users/zhangh24/breast_cancer_data_analysis')
data <- fread("./data/dataset_montse_20180524.txt")
library(data.table)
library(bc2)
data <- fread("./data/dataset_montse_20180524.txt")
getwd()
setwd("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/")
transform <- function(status,tumor){
n <- length(status)
result <- tumor
idx.mis <- which(status==1&is.na(tumor))
result[idx.mis] <- 888
idx.control <- which(status==0)
result[idx.control] <- NA
return(result)
}
data <- fread("./data/dataset_montse_20180524.txt")
idx.remove <- which(data$parity_cat==9|data$breastmos_cat==9)
length(idx.remove)
###########################
data <- fread("./data/dataset_montse_20180524.txt")
idx.remove <- which(data$parity_cat==0|is.na(data$breastmos6)|
data$breastmos_cat==9)
length(idx.remove)
data <- fread("./data/dataset_montse_20180524.txt")
idx.remove <- which(data$parity_cat==9|data$breastmos_cat==9)
length(idx.remove)
install_github("andrewhaoyu/CKLRT")
library(devtools)
install_github("andrewhaoyu/CKLRT")
library(CKLRT)
set.seed(123)
n = 200
X = rnorm(n)
p = 2
G = runif(n*p)< 0.5
G = G + runif(n*p) < 0.5
G = matrix(G, n,p)
E = (runif(n) < 0.5)^2
y = rnorm(n) + G[,1] * 0.3
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
?ginv
install_github("andrewhaoyu/CKLRT")
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
install_github("andrewhaoyu/CKLRT")
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
install_github("andrewhaoyu/CKLRT")
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
install_github("andrewhaoyu/CKLRT")
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
install_github("andrewhaoyu/CKLRT")
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
set.seed(123)
n = 200
X = rnorm(n)
p = 2
G = runif(n*p)< 0.5
G = G + runif(n*p) < 0.5
G = matrix(G, n,p)
E = (runif(n) < 0.5)^2
y = rnorm(n) + G[,1] * 0.3
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
set.seed(123)
n = 200
X = rnorm(n)
p = 2
G = runif(n*p)< 0.5
G = G + runif(n*p) < 0.5
G = matrix(G, n,p)
E = (runif(n) < 0.5)^2
y = rnorm(n) + G[,1] * 0.3
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
set.seed(123)
n = 200
X = rnorm(n)
p = 2
G = runif(n*p)< 0.5
G = G + runif(n*p) < 0.5
G = matrix(G, n,p)
E = (runif(n) < 0.5)^2
y = rnorm(n) + G[,1] * 0.3
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
set.seed(123)
n = 200
X = rnorm(n)
p = 2
G = runif(n*p)< 0.5
G = G + runif(n*p) < 0.5
G = matrix(G, n,p)
E = (runif(n) < 0.5)^2
y = rnorm(n) + G[,1] * 0.3
n = 200
X = rnorm(n)
p = 2
G = runif(n*p)< 0.5
G = G + runif(n*p) < 0.5
G = matrix(G, n,p)
E = (runif(n) < 0.5)^2
y = rnorm(n) + G[,1] * 0.3
omniLRT_fast(y, X = cbind(X,E),K1 = G %*% t(G), K2 = (G*E) %*% t(G * E) , N = 10000, length.rho = 200, length.lambda = 21)
