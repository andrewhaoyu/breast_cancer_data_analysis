temp.x <- strsplit(x,"\\(")
n <- length(x)
result.low <- rep(0,n)
result <- rep(0,n)
result.high <- rep(0,n)
final.result <- rep("c",n)
for(i in 1:n){
result[i] <- round(as.numeric(temp.x[[i]][1]),places)
temp2 <- strsplit(temp.x[[i]][2],"-")
result.low[i] <- round(as.numeric(temp2[[1]][1]),places)
result.high[i] <- round(as.numeric(gsub(")","",temp2[[1]][2])),places)
final.result[i] <- paste0(result[i],"(",result.low[i],"-",result.high[i],")")
}
return(final.result)
}
data[,2] <- process(data[,2])
data[,4] <- process(data[,4])
data[,6] <- process(data[,6])
data[,8] <- process(data[,8])
write.csv(data,"/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/stractch/result/discovery_casecase_2des.csv")
bcda
data <- read.csv("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/discovery_SNP/result/discovery_snp_analysis_results.csv",header=T,stringsAsFactors = F)
tbl_df(data)
library(tidverse)
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
ls()
head(data)
tbl_df(dta)
tbl_df(data)
colnames(data)
n.data <- nrow(data)
for(j in c(11,13,15,17)){
print(j)
for(i in 1:n.data){
print(i)
temp <- data[i,j]
temp2<- strsplit(temp,"-")
odds.high <- as.numeric(gsub(")","",temp2[[1]][2]))
temp3 <- strsplit(temp2[[1]][1],"\\(")
odds <- as.numeric(temp3[[1]][1])
odds.low <- as.numeric(temp3[[1]][2])
odds <- round(odds,plac)
odds.low <- round(odds.low,plac)
odds.high <- round(odds.high,plac)
new <- paste0(odds,"(",odds.low,"-",odds.high,")")
data[i,j] <- new
}
}
plac <- 2
for(j in c(11,13,15,17)){
print(j)
for(i in 1:n.data){
print(i)
temp <- data[i,j]
temp2<- strsplit(temp,"-")
odds.high <- as.numeric(gsub(")","",temp2[[1]][2]))
temp3 <- strsplit(temp2[[1]][1],"\\(")
odds <- as.numeric(temp3[[1]][1])
odds.low <- as.numeric(temp3[[1]][2])
odds <- round(odds,plac)
odds.low <- round(odds.low,plac)
odds.high <- round(odds.high,plac)
new <- paste0(odds,"(",odds.low,"-",odds.high,")")
data[i,j] <- new
}
}
head(data)
write.csv(data,file="/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/discovery_SNP/result/discovery_snp_analysis_results_Rclean.csv)
write.csv(data,file="/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/discovery_SNP/result/discovery_snp_analysis_results_Rclean.csv")
56+20+7+4
164-77
178+10
188+19
n.signals <- c(1,2,3,4)
n.locus <- c(36,13,3,4)
data <- data.farme(n.signals,n.locus)
data <- data.frame(n.signals,n.locus)
p <- ggplot(data,aes(signal,locus))+geom_bar(stat="identity")+
xlab("N signals")+ylab("N locus")+ggtile("Independent signals per region")+theme_bw()
p <- ggplot(data,aes(signal,locus))+geom_bar(stat="identity")+
xlab("N signals")+ylab("N locus")+ggtitle("Independent signals per region")+theme_bw()
n.signals <- c(1,2,3,4)
n.locus <- c(36,13,3,4)
data <- data.frame(n.signals,n.locus)
colnames(data) <- c("signals","locus")
p <- ggplot(data,aes(signal,locus))+geom_bar(stat="identity")+
xlab("N signals")+ylab("N locus")+ggtitle("Independent signals per region")+theme_bw()
n.signals <- c(1,2,3,4)
n.locus <- c(36,13,3,4)
data <- data.frame(n.signals,n.locus)
colnames(data) <- c("signals","locus")
p <- ggplot(data,aes(signal,locus))+geom_bar(stat="identity")+
xlab("N signals")+ylab("N locus")+ggtitle("Independent signals per region")+theme_bw()
n.signals <- c(1,2,3,4)
n.locus <- c(36,13,3,4)
data <- data.frame(n.signals,n.locus)
head(data)
p
colnames(data) <- c("signal","locus")
p <- ggplot(data,aes(signal,locus))+geom_bar(stat="identity")+
xlab("N signals")+ylab("N locus")+ggtitle("Independent signals per region")+theme_bw()
p
p <- ggplot(data,aes(signal,locus))+geom_bar(stat="identity",color="blue")+
xlab("N signals")+ylab("N locus")+ggtitle("Independent signals per region")+theme_bw()
p
p <- ggplot(data,aes(signal,locus))+geom_bar(stat="identity",fill="blue")+
xlab("N signals")+ylab("N locus")+ggtitle("Independent signals per region")+theme_bw()
p
p <- ggplot(data,aes(signal,locus))+geom_bar(stat="identity",fill="#DD8888")+
xlab("N signals")+ylab("N locus")+ggtitle("Independent signals per region")+theme_bw()
p
idx <- which(result.all$mark=="known snp")
top.sig <- result.all[1,c(10,13,14,16)]
152+10+19
data <- read.csv("./data/BCAC_country_distribution.csv")
head(data)
theme_Publication <- function(base_size=14, base_family="helvetica") {
library(grid)
library(ggthemes)
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.2, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
scale_fill_Publication <- function(...){
library(scales)
discrete_scale("fill","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
source("./discovery_SNP/main_plot/code/theme_publication.R")
data <- read.csv("./data/BCAC_country_distribution.csv")
library(ggplot2)
head(data)
head(data1)
data1 <- fread("./data/iCOGS_euro_v10_10232017.csv",header=T)
library(data.table)
data1 <- fread("./data/iCOGS_euro_v10_10232017.csv",header=T)
data1 <- as.data.frame(data1)
age1 <- data1[,204]
idx.complete1 <- which(age1!=888)
age1 <- age1[idx.complete1]
data1.new <- data1[idx.complete1,]
head(data1.new)
data1.new <- data1[idx.complete1,3]
head(data1.new)
data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
data2 <- as.data.frame(data2)
age2 <- data2[,204]
idx.complete2 <- which(age2!=888)
data1.new[,2] <- "OncoArray"
data1 <- fread("./data/iCOGS_euro_v10_10232017.csv",header=T)
data1 <- as.data.frame(data1)
age1 <- data1[,204]
idx.complete1 <- which(age1!=888)
age1 <- age1[idx.complete1]
data1.new <- data1[idx.complete1,3]
data1.new[,2] <- "ICOGs"
data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
data2 <- as.data.frame(data2)
age2 <- data2[,204]
idx.complete2 <- which(age2!=888)
data2.new <- data2[idx.complete2,3]
data2.new[,2] <- "OncoArray"
head(data2.new)
data1.new$project <- "ICOGs"
head(data1.new)
data1.new <- data1[idx.complete1,3]
data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
data2 <- as.data.frame(data2)
age2 <- data2[,204]
idx.complete2 <- which(age2!=888)
data2.coun <- data2[idx.complete2,3]
data2.project <- rep("OncoArray",length(idx.complete2))
data2.new <- data.frame(Country=data2.coun,Project=data2.project)
library(data.table)
data1 <- fread("./data/iCOGS_euro_v10_10232017.csv",header=T)
data1 <- as.data.frame(data1)
age1 <- data1[,204]
idx.complete1 <- which(age1!=888)
age1 <- age1[idx.complete1]
data1.coun <- data1[idx.complete1,3]
data1.project <- rep("ICOGs",length(idx.complete1))
data1.new <- data.frame(Country=data1.coun,Project=data1.project)
data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
data2 <- as.data.frame(data2)
age2 <- data2[,204]
idx.complete2 <- which(age2!=888)
data2.coun <- data2[idx.complete2,3]
data2.project <- rep("OncoArray",length(idx.complete2))
data2.new <- data.frame(Country=data2.coun,Project=data2.project)
data.new <- rbind(data1.new,data2.new)
head(data.new)
p <- ggplot(data.new,aes(x=Country))+geom_bar(stat="indentity")
p <- ggplot(data.new,aes(x=Country))+geom_bar(stat="identity")
p
data <- read.csv("./data/BCAC_country_distribution.csv")
library(ggplot2)
head(data)
data
data <- read.csv("./data/BCAC_country_distribution.csv")
head(data)
data <- read.csv("./data/BCAC_country_distribution.csv")
library(ggplot2)
head(data)
p + scale_fill_brewer(palette="Blues")
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=study))+geom_bar(stat="identity")+theme_minal()
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=study))+geom_bar(stat="identity")+theme_minimal()
p + scale_fill_brewer(palette="Blues")
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity")+theme_minimal()
p + scale_fill_brewer(palette="Blues")
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_brewer(palette="Blues")
p + theme(axis.text.x = element_text(angle = 90, hjust = 1))
p + scale_fill_brewer(palette="Blues") +  theme(axis.text.x = element_text(angle = 90, hjust = 1))
p + scale_fill_brewer(palette="Blues") +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")
p + scale_fill_brewer(palette="Blues") +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + plot.title = element_text(hjust = 0)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_brewer(palette="Blues") +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + plot.title = element_text(hjust = 0)
p + scale_fill_brewer(palette="Blues") +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(plot.title = element_text(hjust = 0))
p + scale_fill_brewer(palette="Blues") +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(plot.title = element_text(hjust = 1))
p + scale_fill_brewer(palette="Blues") +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(plot.title = element_text(hjust = 0.5))
p + scale_fill_brewer(palette="Blues") +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=20),plot.title = element_text(hjust = 0.5))
p + scale_fill_brewer(palette="Blues") +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=16),plot.title = element_text(hjust = 0.5))
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=16),plot.title = element_text(hjust = 0.5))
?png
#
# data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
# data2 <- as.data.frame(data2)
# age2 <- data2[,204]
# idx.complete2 <- which(age2!=888)
# data2.coun <- data2[idx.complete2,3]
# data2.project <- rep("OncoArray",length(idx.complete2))
# data2.new <- data.frame(Country=data2.coun,Project=data2.project)
#
# data.new <- rbind(data1.new,data2.new)
png("/discovery_SNP/main_plot/result/",
width = 8, height = 6, units="inches",res="600")
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=16),plot.title = element_text(hjust = 0.5))
dev.off()
#
# data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
# data2 <- as.data.frame(data2)
# age2 <- data2[,204]
# idx.complete2 <- which(age2!=888)
# data2.coun <- data2[idx.complete2,3]
# data2.project <- rep("OncoArray",length(idx.complete2))
# data2.new <- data.frame(Country=data2.coun,Project=data2.project)
#
# data.new <- rbind(data1.new,data2.new)
png("/discovery_SNP/main_plot/result/Sample_Size_Distribution_Country",
width = 8, height = 6, units="inches",res="600")
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=16),plot.title = element_text(hjust = 0.5))
dev.off()
#
# data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
# data2 <- as.data.frame(data2)
# age2 <- data2[,204]
# idx.complete2 <- which(age2!=888)
# data2.coun <- data2[idx.complete2,3]
# data2.project <- rep("OncoArray",length(idx.complete2))
# data2.new <- data.frame(Country=data2.coun,Project=data2.project)
#
# data.new <- rbind(data1.new,data2.new)
png("/discovery_SNP/main_plot/result/Sample_Size_Distribution_Country",
width = 8, height = 6, units="in",res="600")
#
# data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
# data2 <- as.data.frame(data2)
# age2 <- data2[,204]
# idx.complete2 <- which(age2!=888)
# data2.coun <- data2[idx.complete2,3]
# data2.project <- rep("OncoArray",length(idx.complete2))
# data2.new <- data.frame(Country=data2.coun,Project=data2.project)
#
# data.new <- rbind(data1.new,data2.new)
png("/discovery_SNP/main_plot/result/Sample_Size_Distribution_Country",
width = 8, height = 6, units="cm")
#
# data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
# data2 <- as.data.frame(data2)
# age2 <- data2[,204]
# idx.complete2 <- which(age2!=888)
# data2.coun <- data2[idx.complete2,3]
# data2.project <- rep("OncoArray",length(idx.complete2))
# data2.new <- data.frame(Country=data2.coun,Project=data2.project)
#
# data.new <- rbind(data1.new,data2.new)
png("/discovery_SNP/main_plot/result/Sample_Size_Distribution_Country",
width = 8, height = 6, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=16),plot.title = element_text(hjust = 0.5))
dev.off()
#
# data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
# data2 <- as.data.frame(data2)
# age2 <- data2[,204]
# idx.complete2 <- which(age2!=888)
# data2.coun <- data2[idx.complete2,3]
# data2.project <- rep("OncoArray",length(idx.complete2))
# data2.new <- data.frame(Country=data2.coun,Project=data2.project)
#
# data.new <- rbind(data1.new,data2.new)
png(file="./discovery_SNP/main_plot/result/Sample_Size_Distribution_Country.png",
width = 8, height = 6, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=16),plot.title = element_text(hjust = 0.5))
dev.off()
tion_Country.png",
width = 8, height = 6, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=12),plot.title = element_text(hjust = 0.5))
dev.off()
png(file="./discovery_SNP/main_plot/result/Sample_Size_Distribution_Country.png",
width = 8, height = 6, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=12),plot.title = element_text(hjust = 0.5))
dev.off()
png(file="./discovery_SNP/main_plot/result/Sample_Size_Distribution_Country.png",
width = 8, height = 6, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=6),plot.title = element_text(hjust = 0.5))
dev.off()
#
# data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
# data2 <- as.data.frame(data2)
# age2 <- data2[,204]
# idx.complete2 <- which(age2!=888)
# data2.coun <- data2[idx.complete2,3]
# data2.project <- rep("OncoArray",length(idx.complete2))
# data2.new <- data.frame(Country=data2.coun,Project=data2.project)
#
# data.new <- rbind(data1.new,data2.new)
png(file="./discovery_SNP/main_plot/result/Sample_Size_Distribution_Country.png",
width = 12, height = 8, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=6),plot.title = element_text(hjust = 0.5))
dev.off()
all.countries <- unique(c(data1$StudyCountry,data2$StudyCountry))
all.countrie
all.countries
all.countries
length(all.countries)
table(data1$StudyCountry[idx.complete1])
table(data2$StudyCountry[idx.complete2])
table(data2$StudyCountry[-idx.complete2])
data <- read.csv("./data/BCAC_country_distribution.csv")
data
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=6),plot.title = element_text(hjust = 0.5))
data <- read.csv("./data/BCAC_country_distribution.csv")
library(ggplot2)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=6),plot.title = element_text(hjust = 0.5))
png(file="./discovery_SNP/main_plot/result/Sample_Size_Distribution_Country.png",
width = 12, height = 8, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=6),plot.title = element_text(hjust = 0.5))
dev.off()
#
# data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
# data2 <- as.data.frame(data2)
# age2 <- data2[,204]
# idx.complete2 <- which(age2!=888)
# data2.coun <- data2[idx.complete2,3]
# data2.project <- rep("OncoArray",length(idx.complete2))
# data2.new <- data.frame(Country=data2.coun,Project=data2.project)
#
# data.new <- rbind(data1.new,data2.new)
png(file="./discovery_SNP/main_plot/result/Sample_Size_Distribution_Country.png",
width = 16, height = 12, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=6),plot.title = element_text(hjust = 0.5))
dev.off()
png(file="./discovery_SNP/main_plot/result/Sample_Size_Distribution_Country.png",
width = 16, height = 12, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=8),plot.title = element_text(hjust = 0.5))
dev.off()
png(file="./discovery_SNP/main_plot/result/Sample_Size_Distribution_Country.png",
width = 16, height = 12, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=10),plot.title = element_text(hjust = 0.5))
dev.off()
all.countries <- unique(c(data1$StudyCountry,data2$StudyCountry))
all.countries
y.pheno.mis2.sub <- y.pheno.mis2[idx.onco,]
x.covar.mis2.sub <- y.pheno.mis2[idx.onco,]
data1 <- fread("./data/iCOGS_euro_v10_10232017.csv",header=T)
data1 <- as.data.frame(data1)
age1 <- data1[,204]
idx.complete1 <- which(age1!=888)
age1 <- age1[idx.complete1]
y.pheno.mis1 <- cbind(data1$Behaviour1,data1$ER_status1,data1$PR_status1,data1$HER2_status1,data1$Grade1)
colnames(y.pheno.mis1) = c("Behavior","ER","PR","HER2","Grade")
x.covar.mis1 <- data1[,c(5:14)]
y.pheno.mis1 <- y.pheno.mis1[idx.complete1,]
x.covar.mis1 <- x.covar.mis1[idx.complete1,]
data1 <- data1[idx.complete1,]
data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
data2 <- as.data.frame(data2)
age2 <- data2[,204]
idx.complete2 <- which(age2!=888)
age2 <- age2[idx.complete2]
y.pheno.mis2 <- cbind(data2$Behaviour1,data2$ER_status1,data2$PR_status1,data2$HER2_status1,data2$Grade1)
known.all.mis2 <- data2[,c(27:203,205)]
#y.pheno.mis2 <- cbind(data2$Behaviour1,data2$PR_status1,data2$ER_status1,data2$HER2_status1)
colnames(y.pheno.mis2) = c("Behaviour","ER",
"PR","HER2","Grade")
y.pheno.mis2 <- y.pheno.mis2[idx.complete2,]
x.covar.mis2 <- x.covar.mis2[idx.complete2,]
data2 <- data2[idx.complete2,]
all.countries <- unique(c(data1$StudyCountry,data2$StudyCountry))
idx.
all.countries <- unique(c(data1$StudyCountry,data2$StudyCountry))
idx.onco <- which(data2$StudyCountry=="Macedonia")
y.pheno.mis2.sub <- y.pheno.mis2[idx.onco,]
x.covar.mis2.sub <- y.pheno.mis2[idx.onco,]
dim(y.pheno.mis2.sub)
dim(x.pheno.mis2.sub)
head(discovery.snp.ico)
head(discovery.snp.icog)
head(discovery.snp.icog)
discover.snp.onco.sub <- discovery.snp.onco.complete[idx.onco,i1]
data <- read.csv("./data/BCAC_country_distribution.csv")
library(ggplot2)
# library(data.table)
# data1 <- fread("./data/iCOGS_euro_v10_10232017.csv",header=T)
# data1 <- as.data.frame(data1)
# age1 <- data1[,204]
# idx.complete1 <- which(age1!=888)
# age1 <- age1[idx.complete1]
#
# data1.coun <- data1[idx.complete1,3]
# data1.project <- rep("ICOGs",length(idx.complete1))
#
# data1.new <- data.frame(Country=data1.coun,Project=data1.project)
#
#
#
#
# data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
# data2 <- as.data.frame(data2)
# age2 <- data2[,204]
# idx.complete2 <- which(age2!=888)
# data2.coun <- data2[idx.complete2,3]
# data2.project <- rep("OncoArray",length(idx.complete2))
# data2.new <- data.frame(Country=data2.coun,Project=data2.project)
#
# data.new <- rbind(data1.new,data2.new)
png(file="./discovery_SNP/main_plot/result/Sample_Size_Distribution_Country.png",
width = 16, height = 12, units="cm",res=600)
p <- ggplot(data,aes(x=Country,y=Sample_Size,fill=Study))+geom_bar(stat="identity",color = "black",position=position_dodge())+theme_minimal()
p + scale_fill_manual(values=c('#999999','#E69F00')) +  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Sample Size") +
ggtitle("BCAC Sample Size Distribution Across Country")  + theme(text = element_text(size=10),plot.title = element_text(hjust = 0.5))
dev.off()
print(length(idx.onco))
Heter.result.Icog = EMmvpoly(y.pheno.mis1.sub,baselineonly = NULL,additive = x.all.mis1.sub[,c(2)],pairwise.interaction = NULL,saturated = NULL,missingTumorIndicator = 888)
idx <-
freq.table.mis[i,]
temp <- freq.table.mis[i,1:(n.col-1),drop=F]
