xlab("standard analysis -log10(p-value)")+
#scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"))
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"))
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))
theme_Publication()
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model global association test -log10(p-value)")
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))
theme_Publication()
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model global association test -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
theme_Publication <- function(base_size=14, base_family="") {
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.5, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
theme_Publication <- function(base_size=14, base_family="") {
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.3, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
theme_Publication <- function(base_size=14, base_family="") {
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.3, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
legend.title.size = unit(0.3, "cm"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
theme_Publication <- function(base_size=14, base_family="") {
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.2, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
theme_Publication <- function(base_size=14, base_family="") {
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.01, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
theme_Publication <- function(base_size=14, base_family="") {
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.2, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
lengend.text = element_text(size = 10),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
theme_Publication <- function(base_size=14, base_family="") {
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.2, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
legend.text = element_text(size = 10),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
theme_Publication <- function(base_size=14, base_family="") {
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.2, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic"),
legend.text = element_text(size = 4),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
theme_Publication <- function(base_size=14, base_family="") {
(theme_foundation(base_size=base_size, base_family=base_family)
+ theme(plot.title = element_text(face = "bold",
size = rel(1.2), hjust = 0.5),
text = element_text(),
panel.background = element_rect(colour = NA),
plot.background = element_rect(colour = NA),
panel.border = element_rect(colour = NA),
axis.title = element_text(face = "bold",size = rel(1)),
axis.title.y = element_text(angle=90,vjust =2),
axis.title.x = element_text(vjust = -0.2),
axis.text = element_text(),
axis.line = element_line(colour="black"),
axis.ticks = element_line(),
panel.grid.major = element_line(colour="#f0f0f0"),
panel.grid.minor = element_blank(),
legend.key = element_rect(colour = NA),
legend.position = "bottom",
legend.direction = "horizontal",
legend.key.size= unit(0.2, "cm"),
legend.margin = unit(0, "cm"),
legend.title = element_text(face="italic",size=10),
legend.text = element_text(size = 10),
plot.margin=unit(c(10,5,5,5),"mm"),
strip.background=element_rect(colour="#f0f0f0",fill="#f0f0f0"),
strip.text = element_text(face="bold")
))
}
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
ggtitle("mixed two-stage model versus standard analysis")
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
ggtitle("mixed two-stage model versus standard analysis")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
png("./poland/result/known_snps/figure/Mixed two-stage model versus standard analysis.png",height=495,width = 664)
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
ggtitle("mixed two-stage model versus standard analysis")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
dev.off()
?png
png("./poland/result/known_snps/figure/Mixed two-stage model versus standard analysis.png",height=495,width = 664,res=600)
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
ggtitle("mixed two-stage model versus standard analysis")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
dev.off()
png("./poland/result/known_snps/figure/Mixed two-stage model versus standard analysis.png",height=495,width = 664,res=300)
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
ggtitle("mixed two-stage model versus standard analysis")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
dev.off()
png("./poland/result/known_snps/figure/Mixed two-stage model versus standard analysis.png",height=495,width = 664,res=50)
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
ggtitle("mixed two-stage model versus standard analysis")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
dev.off()
png("./poland/result/known_snps/figure/Mixed two-stage model versus standard analysis.png",height=6,width = 8,units="cm",res=50)
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
ggtitle("mixed two-stage model versus standard analysis")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
dev.off()
png("./poland/result/known_snps/figure/Mixed two-stage model versus standard analysis.png",height=6,width = 8,units="cm",res=300)
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
ggtitle("mixed two-stage model versus standard analysis")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
dev.off()
png("./poland/result/known_snps/figure/Mixed two-stage model versus standard analysis.png",height=6,width = 8,units="in",res=300)
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
ggtitle("mixed two-stage model versus standard analysis")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
dev.off()
png("./poland/result/known_snps/figure/Mixed two-stage model versus standard analysis.png",height=6,width = 8,units="in",res=400)
ggplot(data.plot,aes(x=log_standard,y=log_mix_two_stage,color=heter))+
geom_point()+
#theme_minimal()+
xlab("standard analysis -log10(p-value)")+
ylab("mixed two-stage model -log10(p-value)")+
ggtitle("mixed two-stage model versus standard analysis")+
scale_fill_Publication()+
scale_colour_manual(name="Global heterogeneity test",values=c("#386cb0","#fdb462"),
labels=c("p-value>=0.05","p-value<0.05"))+
theme_Publication()
dev.off()
subtypes1 <- GenerateIntrinsic_new(new.data$Behaviour1,new.data$ER_status1,new.data$PR_status1,new.data$HER2_status1,new.data$Grade1)
?cut
a <- c(1:10)
cut(a,breaks=c(2,3,5,7))
min(age)
cut(a,breaks=c(1,3,5,7))
source('~/GoogleDrive/breast_cancer_data_analysis/poland/code/whole_genome_meta.R', echo=TRUE)
head(onco_result_fixed)
head(onco_result_fixed)
onco_result_fixed_5p <- onco_result_fixed[idx,]
library(data.table)
library(bc2)
data <- fread("./data/dataset_montse_20180522.txt")
head(dta)
head(data)
