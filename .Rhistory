png(filename="./meta_heatmap.png",width=10,heigh=10,units="in",res=300)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
dev.off()
pal.breaks <- seq(-1,1,0.01)
col <- colorRampPalette(c("dodgerblue4","white","red"))(length(pal.breaks)-1)
correlation.matrix.icog <- correlation.matrix
# heatmap(correlation.matrix,col = col,symm=T,margins=c(10,4),key.title="",key.ylab="",cexRow=1,cexCol=1)
png(filename="./meta_heatmap2.png",width=10,heigh=10,units="in",res=300)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
dev.off()
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
?quantile
total1 = 8884+1503+1776+760+2057
8884/total1
1503/total1
1776/total1
760/total1
2057/total1
total2= 24199+5008+5008+2037+5121
24199/total2
5008/total2
5028/total2
2037/total2
5121/total2
total = total1+total2
(8884+24199)/total
(1503+5008)/total
(1776+5028)/total
(760+2037)/total
(2057+5121)/total
15888125/25
343819025/541
log(-5)
diag(5)
load("/spin1/users/zhangh24/breast_cancer_data_analysis/whole_genome_age/ICOG/ERPRHER2GRADE_casecase/result/meta_result_shared_1p.Rdata")
dev.off()
?plot
p.value <- runif(10*10^6)
qq(p.value)
library(qqman)
install.packages("qqman")
library(qqman)
qq(p.value)
#setwd('/spin1/users/zhangh24/breast_cancer_data_analysis/')
load(paste0("./discovery_SNP/sensitivity_analysis/result/sensitivity_result.Rdata"))
library(data.table)
data1 <- fread("./data/iCOGS_euro_v10_10232017.csv",header=T)
data2 <- fread("./data/Onco_euro_v10_10232017.csv",header=T)
all.countries <- unique(c(data1$StudyCountry,data2$StudyCountry))
level1 <- levels(as.factor(all.countries))
n.coun <- 20
all.countries[n.coun+1] <- "Summary"
discover.casecase <- read.csv("./data/discovery_snp_casecase.csv",header = T)
library(forestplot)
plot.list <- list()
discover.casecase
discover.casecase[,1]
discover.casecase <- discover.casecase[c(9,15,13,5,17,4,10,
19,3,14,7)]
discover.casecase <- discover.casecase[c(9,15,13,5,17,4,10,
19,3,14,7),]
discover.casecase[,1]
discover.casecase <- read.csv("./data/discovery_snp_casecase.csv",header = T)
discover.casecase <- discover.casecase[c(9,15,13,5,17,4,10,18
19,3,14,7),]
discover.casecase <- discover.casecase[c(9,15,13,5,17,4,10,18,
19,3,14,7),]
discover.casecase
discover.casecase[,1]
discover.casecase <- read.csv("./data/discovery_snp_casecase.csv",header = T)
discover.casecase <- discover.casecase[c(9,15,13,5,17,4,10,18,
,3,14,7),]
discover.casecase <- read.csv("./data/discovery_snp_casecase.csv",header = T)
discover.casecase <- discover.casecase[c(9,15,13,5,17,4,10,18,
3,14,7),]
discover.casecase[,1]
discover.casecase <- read.csv("./data/discovery_snp_casecase.csv",header = T)
discover.casecase
discover.casecase[,1]
discover.casecase <- discover.casecase[c(1,9,15,13,2,6,5,8,17,4,10,18,
3,14,7,19),]
discover.casecase[,1]
library(forestplot)
plot.list <- list()
for(i1 in 1:16){
print(i1)
data <- sensitivity.result[[i1]]
data <- rbind(data,discover.casecase[i1,2:ncol(discover.casecase)])
all.countries <- factor(all.countries,levels=rev(c(level1,"Summary")))
levels(all.countries)
p <- c(1,4,7,10)
odds = as.vector(as.matrix(data[,p]))
low = c(as.matrix(data[,p+1]))
high <- c(as.matrix(data[,p+2]))
tumor <- c(rep("ER",n.coun+1),rep("PR",n.coun+1),
rep("HER2",n.coun+1),rep("Grade",n.coun+1))
tumor <- factor(tumor,levels = c("ER","PR","HER2","Grade"))
Type <- c(rep("ind",n.coun),"sum")
Type <- rep(Type,4)
#Size <- c(rep(1,n.coun),1)
new.data <- data.frame(odds,
low,
high,
Type,
label = all.countries,
tumor)
library(ggplot2)
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("#386cb0","#fdb462"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
plot.list[[i1]] <- fp
}
i1 = 3
plot.list[[i1]]
library(gridExtra)
width = 21
height = 29
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=21,
height= 29, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot2.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[4]],plot.list[[5]],plot.list[[6]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot3.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[7]],plot.list[[8]],plot.list[[9]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot4.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[10]],plot.list[[11]],plot.list[[12]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot5.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[13]],plot.list[[14]],plot.list[[15]],nrow=3)
dev.off()
library(gridExtra)
width = 21
height = 29
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=21,
height= 29, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot2.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[4]],plot.list[[5]],plot.list[[6]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot3.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[7]],plot.list[[8]],plot.list[[9]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot4.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[10]],plot.list[[11]],plot.list[[12]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot5.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[13]],plot.list[[14]],plot.list[[15]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot6.png",width=width,
height= height, units="cm", res= 600)
plot.list[[16]]
dev.off()
discover.casecase <- read.csv("./data/discovery_snp_casecase.csv",header = T)
discovery.casecase
discover.casecase
new.order <- c(1,9,15,13,2,6,5,8,17,4,10,18,
3,14,7,19)
new.order
new.order <- c(1,9,15,13,2,6,5,8,17,4,10,18,
3,14,7,19)
discover.casecase <- discover.casecase[,]
library(forestplot)
plot.list <- list()
for(i1 in 1:length(new.order)){
print(i1)
data <- sensitivity.result[[new.order[i1]]]
data <- rbind(data,discover.casecase[new.order[i1],2:ncol(discover.casecase)])
all.countries <- factor(all.countries,levels=rev(c(level1,"Summary")))
levels(all.countries)
p <- c(1,4,7,10)
odds = as.vector(as.matrix(data[,p]))
low = c(as.matrix(data[,p+1]))
high <- c(as.matrix(data[,p+2]))
tumor <- c(rep("ER",n.coun+1),rep("PR",n.coun+1),
rep("HER2",n.coun+1),rep("Grade",n.coun+1))
tumor <- factor(tumor,levels = c("ER","PR","HER2","Grade"))
Type <- c(rep("ind",n.coun),"sum")
Type <- rep(Type,4)
#Size <- c(rep(1,n.coun),1)
new.data <- data.frame(odds,
low,
high,
Type,
label = all.countries,
tumor)
library(ggplot2)
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("#386cb0","#fdb462"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
plot.list[[i1]] <- fp
}
library(gridExtra)
width = 21
height = 29
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=21,
height= 29, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot2.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[4]],plot.list[[5]],plot.list[[6]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot3.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[7]],plot.list[[8]],plot.list[[9]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot4.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[10]],plot.list[[11]],plot.list[[12]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot5.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[13]],plot.list[[14]],plot.list[[15]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot6.png",width=width,
height= height, units="cm", res= 600)
plot.list[[16]]
dev.off()
for(i1 in 1:length(new.order)){
print(i1)
data <- sensitivity.result[[new.order[i1]]]
data <- rbind(data,discover.casecase[new.order[i1],2:ncol(discover.casecase)])
all.countries <- factor(all.countries,levels=rev(c(level1,"Summary")))
levels(all.countries)
p <- c(1,4,7,10)
odds = as.vector(as.matrix(data[,p]))
low = c(as.matrix(data[,p+1]))
high <- c(as.matrix(data[,p+2]))
tumor <- c(rep("ER",n.coun+1),rep("PR",n.coun+1),
rep("HER2",n.coun+1),rep("Grade",n.coun+1))
tumor <- factor(tumor,levels = c("ER","PR","HER2","Grade"))
Type <- c(rep("ind",n.coun),"sum")
Type <- rep(Type,4)
#Size <- c(rep(1,n.coun),1)
new.data <- data.frame(odds,
low,
high,
Type,
label = all.countries,
tumor)
library(ggplot2)
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("#386cb0","#fdb462"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[new.order[i1],1])
)+
theme(plot.title = element_text(hjust=0.5))
plot.list[[i1]] <- fp
}
width = 21
height = 29
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=21,
height= 29, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot2.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[4]],plot.list[[5]],plot.list[[6]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot3.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[7]],plot.list[[8]],plot.list[[9]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot4.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[10]],plot.list[[11]],plot.list[[12]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot5.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[13]],plot.list[[14]],plot.list[[15]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot6.png",width=width,
height= height, units="cm", res= 600)
plot.list[[16]]
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot6.png",width=width,
height= height/3, units="cm", res= 600)
plot.list[[16]]
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=21,
height= 29, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],plot.list[[4]],plot.list[[5]],plot.list[[6]],plot.list[[7]],plot.list[[8]],nrow=4,ncol=2)
dev.off()
width = 28
height = 28
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=21,
height= 29, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],plot.list[[4]],plot.list[[5]],plot.list[[6]],plot.list[[7]],plot.list[[8]],nrow=4,ncol=2)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],plot.list[[4]],plot.list[[5]],plot.list[[6]],plot.list[[7]],plot.list[[8]],nrow=4,ncol=2)
dev.off()
width = 36
height = 28
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],plot.list[[4]],plot.list[[5]],plot.list[[6]],plot.list[[7]],plot.list[[8]],nrow=4,ncol=2)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],plot.list[[4]],plot.list[[5]],plot.list[[6]],nrow=3,ncol=2)
dev.off()
width = 36
height = 26
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],plot.list[[4]],plot.list[[5]],plot.list[[6]],nrow=3,ncol=2)
dev.off()
width = 36
height = 25
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],plot.list[[4]],plot.list[[5]],plot.list[[6]],nrow=3,ncol=2)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot2.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[7]],plot.list[[8]],plot.list[[9]],plot.list[[10]],plot.list[[11]],plot.list[[12]],nrow=3,ncol=2)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot3.png",width=width,
height= (height*2/3), units="cm", res= 600)
grid.arrange(plot.list[[13]],plot.list[[14]],plot.list[[15]],plot.list[[16]],nrow=2,ncol=2)
dev.off()
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("./breast_cancer_ldsc/meta_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
places <- 3
covariance.matrix.new <- rep("c",25)
correlation.matrix
covariance.matrix.new <- rep("c",25)
covariance.matrix.transform <- log(covariance.matrix)
covariance.matrix.transform.low <- covariance.matrix.transform - 1.96*covariance.matrix.se/covariance.matrix
covariance.matrix.transform.high <- covariance.matrix.transform + 1.96*covariance.matrix.se/covariance.matrix
covariance.matrix.high <- exp(covariance.matrix.transform.high)
covariance.matrix.transform.low  <- exp(covariance.matrix.transform.low)
covariance.matrix.high <- round(covariance.matrix.high,places)
covariance.matrix.low <- round(covariance.matrix.low,places)
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
places <- 3
covariance.matrix.new <- rep("c",25)
covariance.matrix.transform <- log(covariance.matrix)
covariance.matrix.transform.low <- covariance.matrix.transform - 1.96*covariance.matrix.se/covariance.matrix
covariance.matrix.transform.high <- covariance.matrix.transform + 1.96*covariance.matrix.se/covariance.matrix
covariance.matrix.high <- exp(covariance.matrix.transform.high)
covariance.matrix.transform.low  <- exp(covariance.matrix.transform.low)
covariance.matrix.high <- round(covariance.matrix.high,places)
covariance.matrix.low <- round(covariance.matrix.low,places)
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
places <- 3
covariance.matrix.new <- rep("c",25)
covariance.matrix.transform <- log(covariance.matrix)
covariance.matrix.transform.low <- covariance.matrix.transform - 1.96*covariance.matrix.se/covariance.matrix
covariance.matrix.transform.high <- covariance.matrix.transform + 1.96*covariance.matrix.se/covariance.matrix
covariance.matrix.high <- exp(covariance.matrix.transform.high)
covariance.matrix.transform.low  <- exp(covariance.matrix.transform.low)
covariance.matrix.high <- round(covariance.matrix.high,places)
covariance.matrix.low <- round(covariance.matrix.low,places)
covariance.matrix.low  <- exp(covariance.matrix.transform.low)
covariance.matrix.high <- round(covariance.matrix.high,places)
covariance.matrix.low <- round(covariance.matrix.low,places)
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix.low[i,j],"-",covariance.matrix.high[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix <- round(correlation.matrix,places)
correlation.matrix.low <- round(correlation.matrix.low,places)
correlation.matrix.high <- round(correlation.matrix.high,places)
correlation.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,5,5)
covariance.matrix.icog <- covariance.matrix.new
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
correlation.matrix <- as.matrix(as.data.frame(fread("genetic_correlation_meta.csv")[,1:5]))
rownames(correlation.matrix) <- colnames(correlation.matrix)
pal.breaks <- seq(0,1,0.01)
col <- colorRampPalette(c("dodgerblue4","white","red"))(length(pal.breaks)-1)
correlation.matrix.icog <- correlation.matrix
correlation.matrix <- as.matrix(as.data.frame(fread("genetic_correlation_meta.csv")[,1:5]))
rownames(correlation.matrix) <- colnames(correlation.matrix)
pal.breaks <- seq(0,1,0.01)
col <- colorRampPalette(c("dodgerblue4","white","red"))(length(pal.breaks)-1)
correlation.matrix.icog <- correlation.matrix
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
correlation.matrix
load("./breast_cancer_ldsc/meta_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
correlation.matrix
rownames(correlation.matrix) <- colnames(correlation.matrix)
pal.breaks <- seq(0,1,0.01)
col <- colorRampPalette(c("dodgerblue4","white","red"))(length(pal.breaks)-1)
correlation.matrix.icog <- correlation.matrix
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
pal.breaks <- seq(0.4,1,0.01)
col <- colorRampPalette(c("white","red"))(length(pal.breaks)-1)
correlation.matrix.icog <- correlation.matrix
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
png(filename="./meta_heatmap.png",width=10,heigh=10,units="in",res=300)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
dev.off()
y <- as.data.frame(fread("./data/discovery_icog_data.csv",header=T))
getwd()
setwd( "/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/")
y <- as.data.frame(fread("./data/discovery_icog_data.csv",header=T))
head9Y
data1 <- as.data.frame(fread("./data/discovery_icog_data.csv",header=T))
data1 <- as.data.frame(fread("./data/iCOGS_euro_v10_10232017.csv",header=T))
y.pheno.mis1 <- cbind(data1$Behaviour1,data1$ER_status1,data1$PR_status1,data1$HER2_status1)
Generatezstandard(y.pheno.mis1)
GenerateZstandard(y.pheno.mis1)
library(bc2)
GenerateZstandard(y.pheno.mis1)
GenerateZstandard(y.pheno.mis1)
install_github("andrewhaoyu/bc2"）
install_github("andrewhaoyu/bc2")
library(devtools)
install_github("andrewhaoyu/bc2")
library(bc2)
GenerateZstandard(y.pheno.mis1)
?merge
(60+1100-45.72)/2
37628+58134
34783+71788
37628+34783
37628
37628+58134
21655+48375
"/spin1/users/zhangh24/breast_cancer_data_analysis/whole_genome_age/ICOG/Intrinsic_subtypes/result/Icog_result_intrinsic_subtype.Rdata"
