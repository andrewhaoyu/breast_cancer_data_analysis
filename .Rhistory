fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)
fp
#Size <- c(rep(1,n.coun),1)
new.data <- data.frame(odds,
low,
high,
Type,
label = all.countries,
tumor)
data <- sensitivity.result[[1]]
data <- rbind(data,discover.casecase[i1,2:ncol(discover.casecase)])
all.countries <- factor(all.countries,levels=rev(c(level1,"Summary")))
levels(all.countries)
p <- c(1,4,7,10)
odds = c(data[,p])
low = c(data[,p+1])
high <- c(data[,p+2])
tumor <- c(rep("ER",n.coun+1),rep("PR",n.coun+1),
rep("HER2",n.coun+1),rep("Grade",n.coun+1))
Type <- c(rep("ind",n.coun),"sum")
Type <- rep(Type,4)
#Size <- c(rep(1,n.coun),1)
new.data <- data.frame(odds,
low,
high,
Type,
label = all.countries,
tumor)
library(ggplot2)
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)
fp
head(new.data)
odds
data[,p]
odds = as.vector(data[,p])
odds
class(vector)
class(odds)
class(odds)
odds = as.vector(data[,p])
odds
class(odds)
odds = as.vector(as.matrix(data[,p]))
odds
high <- c(as.matrix(data[,p+2]))
source('~/GoogleDrive/breast_cancer_data_analysis/discovery_SNP/sensitivity_analysis/code/forest_plot.R', echo=TRUE)
tumor <- factor(tumor,levels = c("ER","PR","HER2","Grade"))
Type <- c(rep("ind",n.coun),"sum")
Type <- rep(Type,4)
#Size <- c(rep(1,n.coun),1)
new.data <- data.frame(odds,
low,
high,
Type,
label = all.countries,
tumor)
library(ggplot2)
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)
fp
head(discover.casecase)
discover.casecase <- read.csv("./data/discovery_snp_casecase.csv",header = T)
head(discover.casecase)
discover.casecase[1,1]
ggtitle(paset0("Forest Plot of", discover.casecase[i1,1])
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paset0("Forest Plot of", discover.casecase[i1,1]))
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest Plot of", discover.casecase[i1,1]))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest Plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest Plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=1))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest Plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=tumor))+
geom_pointrange()+
scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=tumor))+
geom_pointrange()+
# scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
# scale_colour_manual(values=c("black","red"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("dodgerblue4","#c0392b"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("chartreuse4","#c0392b"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("gray15","#c0392b"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("#386cb0","#c0392b"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
fp
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("#386cb0","#fdb462"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
fp
plot.list <- list()
plot.list <- list()
for(i1 in 1:19){
print(i1)
data <- sensitivity.result[[i1]]
data <- rbind(data,discover.casecase[i1,2:ncol(discover.casecase)])
all.countries <- factor(all.countries,levels=rev(c(level1,"Summary")))
levels(all.countries)
p <- c(1,4,7,10)
odds = as.vector(as.matrix(data[,p]))
low = c(as.matrix(data[,p+1]))
high <- c(as.matrix(data[,p+2]))
tumor <- c(rep("ER",n.coun+1),rep("PR",n.coun+1),
rep("HER2",n.coun+1),rep("Grade",n.coun+1))
tumor <- factor(tumor,levels = c("ER","PR","HER2","Grade"))
Type <- c(rep("ind",n.coun),"sum")
Type <- rep(Type,4)
#Size <- c(rep(1,n.coun),1)
new.data <- data.frame(odds,
low,
high,
Type,
label = all.countries,
tumor)
library(ggplot2)
fp <- ggplot(new.data,aes(x=label,y=odds,ymin=low,ymax=high,shape=Type,colour=Type))+
geom_pointrange()+
scale_colour_manual(values=c("#386cb0","#fdb462"))+
#geom_line(yintercept=1,lty=2)+
coord_flip()+
theme_bw()+
geom_hline(yintercept=1,size=1,lty=2)+
theme(legend.position="none")+
ylab("Odds Ratio (95% CI)")+
#scale_y_continuous(limits=c(0.90,1.1))+
xlab("Removed Countries")+
facet_grid(.~tumor)+
ggtitle(paste0("Forest plot of ", discover.casecase[i1,1])
)+
theme(plot.title = element_text(hjust=0.5))
plot.list[[i1]] <- fp
}
plot.list[[i1]]
i1 = 1
plot.list[[i1]]
i1 = 2
plot.list[[i1]]
i1 = 3
plot.list[[i1]]
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
library(gridExtra)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
ggsave(plot1,"./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=20,
height 60, units=cm)
ggsave(plot1,"./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=20,
height= 60, units=cm)
ggsave("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=20,
height= 60, units=cm)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
ggsave("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=20,
height= 60, units=cm)
ggsave("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=20,
height= 60, units=cm, res= 600)
ggsave("sensitivity_plot1.png",width=20,
height= 60, units=cm, res= 600)
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=20,
height= 60, units=cm, res= 600)
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=20,
height= 60, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=40,
height= 80, units="inches", res= 1000)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=40,
height= 80, units="in", res= 1000)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=60,
height= 100, units="in", res= 1000)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=60,
height= 100, units="in", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=19,
height= 27, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot2.png",width=19,
height= 27, units="cm", res= 600)
grid.arrange(plot.list[[4]],plot.list[[5]],plot.list[[6]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot5.png",width=19,
height= 27, units="cm", res= 600)
grid.arrange(plot.list[[13]],plot.list[[14]],plot.list[[15]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot7.png",width=19/3,
height= 27/3, units="cm", res= 600)
plot.list[[19]]
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=19,
height= 27, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot2.png",width=19,
height= 27, units="cm", res= 600)
grid.arrange(plot.list[[4]],plot.list[[5]],plot.list[[6]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot3.png",width=19,
height= 27, units="cm", res= 600)
grid.arrange(plot.list[[7]],plot.list[[8]],plot.list[[9]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot4.png",width=19,
height= 27, units="cm", res= 600)
grid.arrange(plot.list[[10]],plot.list[[11]],plot.list[[12]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot5.png",width=19,
height= 27, units="cm", res= 600)
grid.arrange(plot.list[[13]],plot.list[[14]],plot.list[[15]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot6.png",width=19,
height= 27, units="cm", res= 600)
grid.arrange(plot.list[[16]],plot.list[[17]],plot.list[[18]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot7.png",width=19/3,
height= 27/3, units="cm", res= 600)
plot.list[[19]]
dev.off()
width = 21
height = 29
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot1.png",width=21,
height= 29, units="cm", res= 600)
grid.arrange(plot.list[[1]],plot.list[[2]],plot.list[[3]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot2.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[4]],plot.list[[5]],plot.list[[6]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot3.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[7]],plot.list[[8]],plot.list[[9]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot4.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[10]],plot.list[[11]],plot.list[[12]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot5.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[13]],plot.list[[14]],plot.list[[15]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot6.png",width=width,
height= height, units="cm", res= 600)
grid.arrange(plot.list[[16]],plot.list[[17]],plot.list[[18]],nrow=3)
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot7.png",width=width/3,
height= height/3, units="cm", res= 600)
plot.list[[19]]
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot7.png",width=(width/3),
height= (height/3), units="cm", res= 600)
plot.list[[19]]
dev.off()
png("./discovery_SNP/sensitivity_analysis/result/sensitivity_plot7.png",width=(width),
height= (height/3), units="cm", res= 600)
plot.list[[19]]
dev.off()
z.design.Grade <- matrix(0,M,3)
idx.Grade1 <- which(z.standard[,4]==1)
z.design.Grade[,1] <- 1
idx.Grade2 <- which(z.standard[,4]!=1)
z.design.Grade[idx.Grade2,2] <- 1
idx.Grade3 <- which(z.standard[,4]==3)
z.design.Grade[idx.Grade3,3] <- 1
colnames(z.design.Grade) <- c("Grade1","Grade2","Grade3")
merge(data1,data2,by.x="name",by.y="nm")
data1 <- data.frame(name=c("USA","UK","AUS","CH"),
money = c(1,2,3,4))
data2 <- data.frame(nm=c("USA","CH","Ru"),
height = c(123,123,123))
merge(data1,data2,by.x="name",by.y="nm")
merge(data1,data2,by.x="name",by.y="nm",all.x=T)
merge(data1,data2,by.x="name",by.y="nm",all.x=T,all.y=T)
a <- c(1,2,3,4)
b <- c(2,4,7,8)
match(a,b)
idx.match 《- match(a,b)
idx.match <- match(a,b)
a[]
a[idx.match]
b[idx.match]
a <- c(1,2,3,4)
b <- c(2,4)
idx.match <- match(a,b)
a[idx.match]
b[idx.match]
a <- c(1,2,3,4)
b <- c(2,4,7)
idx.match <- match(a,b)
a[idx.match]
b[idx.match]
a <- c(0.1,0.2,0.3,0.4)
b <- c(0.2,0.4,0.7)
idx.match <- match(a,b)
a[idx.match]
b[idx.match]
idx.match
a%in%b
head(shared.data)
rm(list=ls())
