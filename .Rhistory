# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 13,
cellwidth=220, cellheight=16
# main              = "Default Heatmap"
)
png("H3K27_z.png", height = 24, width  = 18.5, units="cm",res = 300)
#par(font.axis = 2)
pheatmap(
mat               = celltype220_data_H3K27ac,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K27ac,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 13,
cellwidth=220, cellheight=16
# main              = "Default Heatmap"
)
#axis(side = 2, font = 2)
dev.off()
###############generate the plot for H3K4me1
idx <- which(celltypes220_lua$mark=="H3K4me1")
celltype220_data_H3K4me1 <- celltype220_data[idx,]
row.names(celltype220_data_H3K4me1) <- as.character(big_cell_type[idx,1])
group_H3K4me1 <- data.frame(group = as.character(cell_type_10[idx,]),stringsAsFactors = F)
row.names(group_H3K4me1) <- row.names(celltype220_data_H3K4me1)
group_H3K4me1 <- data.frame(group_H3K4me1)
colnames(group_H3K4me1) <- "Cell type"
# library(pheatmap)
# library(RColorBrewer)
# library(viridis)
paletteLength <- 50
annotation_colors = annotation_colors_full
annotation_colors$group <- annotation_colors_full$group[names(annotation_colors_full$group)%in%as.character(unique(cell_type_10[idx,]))]
names(annotation_colors) <- "Cell type"
my.color <- colorRampPalette(c("dodgerblue4", "white", "#c0392b"))(paletteLength)
myBreaks <- c(seq(min(celltype220_data_H3K4me1), 0, length.out=ceiling(paletteLength/2) + 1),
seq(max(celltype220_data_H3K4me1)/paletteLength, max(celltype220_data_H3K4me1), length.out=floor(paletteLength/2)))
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12
# main              = "Default Heatmap"
)
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12
# main              = "Default Heatmap"
)
dev.off()
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12
# main              = "Default Heatmap"
)
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12,
cellwidth=220, cellheight=16
# main              = "Default Heatmap"
)
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12,
cellwidth=220, cellheight=14
# main              = "Default Heatmap"
)
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12,
cellwidth=220, cellheight=12
# main              = "Default Heatmap"
)
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12,
cellwidth=220, cellheight=11
# main              = "Default Heatmap"
)
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12,
cellwidth=220, cellheight=10
# main              = "Default Heatmap"
)
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12,
cellwidth=200, cellheight=10
# main              = "Default Heatmap"
)
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12,
cellwidth=180, cellheight=10
# main              = "Default Heatmap"
)
getwd()
#par(font.axis = 2)
pheatmap(
mat               = celltype220_data_H3K27ac,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K27ac,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 13,
cellwidth=220, cellheight=16
# main              = "Default Heatmap"
)
png("H3K27_z.png", height = 1156, width  = 1026)
#par(font.axis = 2)
pheatmap(
mat               = celltype220_data_H3K27ac,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K27ac,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 13,
cellwidth=220, cellheight=16
# main              = "Default Heatmap"
)
#axis(side = 2, font = 2)
dev.off()
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12,
cellwidth=180, cellheight=10
# main              = "Default Heatmap"
)
dev.off()
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12,
cellwidth=180, cellheight=10
# main              = "Default Heatmap"
)
pheatmap(
mat               = celltype220_data_H3K4me1,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me1,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 11,
cellwidth=180, cellheight=10
# main              = "Default Heatmap"
)
###############generate the plot for H3K4me3
idx <- which(celltypes220_lua$mark=="H3K4me3")
celltype220_data_H3K4me3 <- celltype220_data[idx,]
row.names(celltype220_data_H3K4me3) <- as.character(big_cell_type[idx,1])
group_H3K4me3 <- data.frame(group = as.character(cell_type_10[idx,]),stringsAsFactors = F)
row.names(group_H3K4me3) <- row.names(celltype220_data_H3K4me3)
group_H3K4me3 <- data.frame(group_H3K4me3)
colnames(group_H3K4me3) <- "Cell type"
# library(pheatmap)
# library(RColorBrewer)
# library(viridis)
paletteLength <- 50
annotation_colors = annotation_colors_full
annotation_colors$group <- annotation_colors_full$group[names(annotation_colors_full$group)%in%as.character(unique(cell_type_10[idx,]))]
names(annotation_colors) <- "Cell type"
my.color <- colorRampPalette(c("dodgerblue4", "white", "#c0392b"))(paletteLength)
myBreaks <- c(seq(min(celltype220_data_H3K4me3), 0, length.out=ceiling(paletteLength/2) + 1),
seq(max(celltype220_data_H3K4me3)/paletteLength, max(celltype220_data_H3K4me3), length.out=floor(paletteLength/2)))
pheatmap(
mat               = celltype220_data_H3K4me3,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me3,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12
# main              = "Default Heatmap"
)
dev.off()
pheatmap(
mat               = celltype220_data_H3K4me3,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me3,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12
# main              = "Default Heatmap"
)
pheatmap(
mat               = celltype220_data_H3K4me3,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me3,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 11,
cellwidth=180, cellheight=10
# main              = "Default Heatmap"
)
###############generate the plot for H3K9ac
idx <- which(celltypes220_lua$mark=="H3K9ac")
celltype220_data_H3K9ac <- celltype220_data[idx,]
row.names(celltype220_data_H3K9ac) <- as.character(big_cell_type[idx,1])
group_H3K9ac <- data.frame(group = as.character(cell_type_10[idx,]),stringsAsFactors = F)
row.names(group_H3K9ac) <- row.names(celltype220_data_H3K9ac)
group_H3K9ac <- data.frame(group_H3K9ac)
colnames(group_H3K9ac) <- "Cell type"
# library(pheatmap)
# library(RColorBrewer)
# library(viridis)
paletteLength <- 50
annotation_colors = annotation_colors_full
annotation_colors$group <- annotation_colors_full$group[names(annotation_colors_full$group)%in%as.character(unique(cell_type_10[idx,]))]
names(annotation_colors) <- "Cell type"
my.color <- colorRampPalette(c("dodgerblue4", "white", "#c0392b"))(paletteLength)
myBreaks <- c(seq(min(celltype220_data_H3K9ac), 0, length.out=ceiling(paletteLength/2) + 1),
seq(max(celltype220_data_H3K9ac)/paletteLength, max(celltype220_data_H3K9ac), length.out=floor(paletteLength/2)))
pheatmap(
mat               = celltype220_data_H3K9ac,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K9ac,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 12
# main              = "Default Heatmap"
)
###############generate the plot for H3K27ac
idx <- which(celltypes220_lua$mark=="H3K27ac")
celltype220_data_H3K27ac <- celltype220_data[idx,]
row.names(celltype220_data_H3K27ac) <- as.character(celltypes220_lua$cell_type[idx])
group_H3K27ac <- data.frame(group = as.character(cell_type_10[idx,]),stringsAsFactors = F)
row.names(group_H3K27ac) <- row.names(celltype220_data_H3K27ac)
group_H3K27ac <- data.frame(group_H3K27ac)
colnames(group_H3K27ac) <- "Cell type"
# library(pheatmap)
# library(RColorBrewer)
# library(viridis)
paletteLength <- 50
annotation_colors = annotation_colors_full
annotation_colors$group <- annotation_colors_full$group[names(annotation_colors_full$group)%in%as.character(unique(cell_type_10[idx,]))]
names(annotation_colors) <- "Cell type"
my.color <- colorRampPalette(c("dodgerblue4", "white", "#c0392b"))(paletteLength)
myBreaks <- c(seq(min(celltype220_data_H3K27ac), 0, length.out=ceiling(paletteLength/2) + 1),
seq(max(celltype220_data_H3K27ac)/paletteLength, max(celltype220_data_H3K27ac), length.out=floor(paletteLength/2)))
#par(font.axis = 2)
pheatmap(
mat               = celltype220_data_H3K27ac,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K27ac,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 13,
cellwidth=220, cellheight=16
# main              = "Default Heatmap"
)
es220_lua$mark=="H3K4me3")
###############generate the plot for H3K4me3
idx <- which(celltypes220_lua$mark=="H3K4me3")
celltype220_data_H3K4me3 <- celltype220_data[idx,]
row.names(celltype220_data_H3K4me3) <- as.character(big_cell_type[idx,1])
group_H3K4me3 <- data.frame(group = as.character(cell_type_10[idx,]),stringsAsFactors = F)
row.names(group_H3K4me3) <- row.names(celltype220_data_H3K4me3)
group_H3K4me3 <- data.frame(group_H3K4me3)
colnames(group_H3K4me3) <- "Cell type"
# library(pheatmap)
# library(RColorBrewer)
# library(viridis)
paletteLength <- 50
annotation_colors = annotation_colors_full
annotation_colors$group <- annotation_colors_full$group[names(annotation_colors_full$group)%in%as.character(unique(cell_type_10[idx,]))]
names(annotation_colors) <- "Cell type"
my.color <- colorRampPalette(c("dodgerblue4", "white", "#c0392b"))(paletteLength)
myBreaks <- c(seq(min(celltype220_data_H3K4me3), 0, length.out=ceiling(paletteLength/2) + 1),
seq(max(celltype220_data_H3K4me3)/paletteLength, max(celltype220_data_H3K4me3), length.out=floor(paletteLength/2)))
pheatmap(
mat               = celltype220_data_H3K4me3,
color             = my.color,
breaks           = myBreaks,
cluster_rows=T,
cluster_cols=F,
annotation_row = group_H3K4me3,
annotation_colors = annotation_colors,
# border_color      = NA,
# show_colnames     = FALSE,
# show_rownames     = FALSE,
# annotation_col    = mat_col,
# annotation_colors = mat_colors,
# drop_levels       = TRUE,
fontsize          = 11,
cellwidth=180, cellheight=10
# main              = "Default Heatmap"
)
0.6*0.6+0.4*0.4+0.6*0.6
0.6*0.6+0.4*0.4+0.6*0.4
50-3.5
46.5/5
179*5
895+130+359
209*5
1045+130+359
30+1+3+3+4
6^13
