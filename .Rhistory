idx <- which(case_control_meta_result_final$CHR==1)
range(case_control_meta_result_final$position[idx])
idx <- which(case_control_meta_result_final$CHR==2)
range(case_control_meta_result_final$position[idx])
idx <- which(case_control_meta_result_final$CHR==3)
range(case_control_meta_result_final$position[idx])
head(case_control_meta_result_final)
head(icog_result)
dim(icog_result)
head(icog_reuslt)
head(icog_result)
head(icog_result)
position <- icog_result$position
n <- length(position)
CHR <- rep(0,n)
CHR.temp <- 1
current <- 0
for(i in 1:n){
temp <- position[i]
if(i%%1000==0){
print(i)
}
if(current<temp){
CHR[i] <- CHR.temp
current <- temp
}else{
CHR.temp = CHR.temp+1
current = temp
CHR[i] <- CHR.temp
}
}
i
i
head(CHR)
CHR[119423]
CHR[119422]
position[119000:119100]
position[119000:119200]
position[119000:119422]
CHR.temp
CHR[119000:120000]
CHR[118000:120000]
CHR[117000:120000]
idx <- which(CHR==2)
idx[1]
length(idx)
position[idx]
idx
position[1:67]
n <- length(position)
CHR <- rep(0,n)
CHR.temp <- 1
current <- 0
for(i in 1:n){
temp <- position[i]
if(i%%1000==0){
print(i)
}
if(current<temp){
CHR[i] <- CHR.temp
current <- temp
}else{
CHR.temp = CHR.temp+1
current = temp
CHR[i] <- CHR.temp
}
}
diff.position <- diff(position)
head(diff.position)
length(diff.position)
n
idx <- which(diff.position<0)
idx
length(idx)
position[1641403:1641404]
idx[1]
length(idx)
n <- length(position)
CHR <- rep(22,n)
position.diff <- diff(position)
idx <- which(position.diff<0)
start <- 1
temp <- 1
for(i in 1:length(idx)){
end <- idx[i]
CHR[start:end] <- temp
start <- end+1
temp = temp+1
}
CHR[1641403:1641404]
CHR[3393662:3393663]
position[3393662:3393663]
CHR.generate <- function(position){
n <- length(position)
CHR <- rep(22,n)
position.diff <- diff(position)
idx <- which(position.diff<0)
start <- 1
temp <- 1
for(i in 1:length(idx)){
end <- idx[i]
CHR[start:end] <- temp
start <- end+1
temp = temp+1
}
return(CHR)
}
CHR.generate <- function(position){
n <- length(position)
CHR <- rep(22,n)
position.diff <- diff(position)
idx <- which(position.diff<0)
start <- 1
temp <- 1
for(i in 1:length(idx)){
end <- idx[i]
CHR[start:end] <- temp
start <- end+1
temp = temp+1
}
return(CHR)
}
head(icog_reuslt)
head(icog_result)
CHR_generate <- function(position){
n <- length(position)
CHR <- rep(22,n)
position.diff <- diff(position)
idx <- which(position.diff<0)
start <- 1
temp <- 1
for(i in 1:length(idx)){
end <- idx[i]
CHR[start:end] <- temp
start <- end+1
temp = temp+1
}
return(CHR)
}
CHR <- CHR_generate(icog_result$position)
icog_result.chr <- CHR
icog.chr.bp <- cbind(icog_result.chr,icog_result$position)
icog.chr.pos <- apply(icog.chr.bp,1,paste0,collapse=":")
length(icog.chr.pos)
dim(icog_result)
save(icog.chr.pos,file="/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/ICOG/icog.chr.pos.Rdata")
icog.result$chr.pos <- icog.chr.pos
icog_result$chr.pos <- icog.chr.pos
head(icog_result)
head(hap3)
icog_new <- merge(hap3,icog_result,by.x="chr.pos",by.y = "chr.pos")
head(icog_new)
rho <- rep(0,205)
for(i in 1:205){
rho[i] <- sigma.heter[i]/(sigma.heter[i]+sigma.log.odds.two.stage[i])
}
ls()
dim(icog_reuslt)
dim(icog_result)
head(icog_result)
icog_result[c(3916,4349),]
head(icog_result)
icog_result[3916,]
head(shared.data)
shared.data[1:100,]
shared.data[100:w00,]
shared.data[100:w00,]
shared.data[100:200,]
class(shared.data)
as.data.frame(shared.data[100:200,])
dim(shared.data)
shared.data.icog <- shared.data[,c(1,2,3,4,5,8,9)]
head(shared.data.icog)
colnames(shared.data)
shared.data.icog <- shared.data[,c(1,2,5,6,7,10,11)]
head(shared.data.icog)
temp <- strsplit(shared.data.icog$rs_id)
temp <- strsplit(shared.data.icog$rs_id,":")
temp[[1]]
n <- nrow(shared.data.icog)
A1 <- rep(0,nrow(shared.data.icog))
A2 <- rep(0,nrow(shared.data.icog))
for(i in 1:n){
print(i)
temp <- strsplit(shared.data.icog$rs_id,":")
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
n <- nrow(shared.data.icog)
A1 <- rep(0,nrow(shared.data.icog))
A2 <- rep(0,nrow(shared.data.icog))
temp <- strsplit(shared.data.icog$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
head(A1)
head(A2)
shared.data.icog$A1 <- A1
shared.data.icog$A2 <- A2
head(shared.data.icog)
try <- matrix(0,3,3)
try
tyr[2,1] <- NA
try[2,1] <- NA
try[3,2] <- NA
try
complete(try)
library(tidyverse)
complete(try)
complete(try,c(1,2))
try <- as.data.frame(try)
head(try)
complete(try)
complete(try,c(1,2))
complete.cases(try)
na.omit(try)
shared.icog.data.complete <- complete.cases(shared.data.icog)
head(shared.icog.data.complete)
shared.icog.data.complete <- na.omit(shared.data.icog)
dim(shared.icog.data.complete)
head(shared.icog.data.complete)
setwd("/Users/zhangh24/GoogleDrive/")
setwd("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/")
save(shared.icog.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/ICOG/shared.icog.data.complete.Rdata")
head(onco_result)
setwd("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/")
library(data.table)
hap3 <- fread("./data/HM3snplist_withCHRBP.txt",header=T)
dim(hap3)
CHR_generate <- function(position){
n <- length(position)
CHR <- rep(22,n)
position.diff <- diff(position)
idx <- which(position.diff<0)
start <- 1
temp <- 1
for(i in 1:length(idx)){
end <- idx[i]
CHR[start:end] <- temp
start <- end+1
temp = temp+1
}
return(CHR)
}
hap3.chr.bp <- cbind(hap3[,4],hap3[,5])
hap3.chr.bp.uni <- apply(hap3.chr.bp,1,paste0,collapse = ":")
dim(hap3)
length(hap3.chr.bp.uni)
hap3$chr.pos <- hap3.chr.bp.uni
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/ICOG/icog_result_odds_sd.Rdata")
CHR <- CHR_generate(icog_result$position)
icog_result.chr <- CHR
icog.chr.bp <- cbind(icog_result.chr,icog_result$position)
icog.chr.pos <- apply(icog.chr.bp,1,paste0,collapse=":")
icog_result$chr.pos <- icog.chr.pos
save(icog.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/ICOG/icog.chr.pos.Rdata")
head(icog_new)
colnames(icog_new)
shared.data.icog <- icog_new[,c(1,2,5,6,8,11,18,19)]
head(shared.data.icog)
shared.data.icog <- icog_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.icog)
n <- nrow(shared.data.icog)
A1 <- rep(0,nrow(shared.data.icog))
A2 <- rep(0,nrow(shared.data.icog))
temp <- strsplit(shared.data.icog$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.icog$A1 <- A1
shared.data.icog$A2 <- A2
head(shared.data.icog)
shared.icog.data.complete <- na.omit(shared.data.icog)
head(shared.icog.data.complete)
dim(shared.icog.data.complete)
save(shared.icog.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/ICOG/shared.icog.data.complete.Rdata")
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/ONCO/onco_result_odds_sd.Rdata")
head(onco_result)
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/ONCO/onco_result_odds_sd.Rdata")
CHR <- CHR_generate(onco_result$position)
onco_result.chr <- CHR
onco.chr.bp <- cbind(onco_result.chr,onco_result$position)
onco.chr.pos <- apply(onco.chr.bp,1,paste0,collapse=":")
onco_result$chr.pos <- onco.chr.pos
save(onco.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/onco/onco.chr.pos.Rdata")
onco_new <- merge(hap3,onco_result,by.x="chr.pos",by.y = "chr.pos")
head(onco_new)
colnames(onco_new)
shared.data.onco <- onco_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.onco)
head(shared.data.icog)
n <- nrow(shared.data.onco)
A1 <- rep(0,nrow(shared.data.onco))
A2 <- rep(0,nrow(shared.data.onco))
temp <- strsplit(shared.data.onco$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.onco$A1 <- A1
shared.data.onco$A2 <- A2
shared.onco.data.complete <- na.omit(shared.data.onco)
dim(shared.onco.data.complete)
dim(shared.icog.data.complete)
head(shared.data.onco)
head(shared.data.icog)
save(shared.onco.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/ONCO/shared.onco.data.complete.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/meta/case_control_meta_result_final.Rdata")
head(case_control_meta_result_final)
dim(case_control_meta_result_final)
length(bcac.chr.bp.uni)
meta.chr.bp <- bcac.chr.bp.uni
save(meta.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/meta/meta.chr.pos.Rdata")
meta.chr.pos <- meta.chr.bp
save(meta.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/meta/meta.chr.pos.Rdata")
shared.data <- merge(hap3,case_control_meta_result_final,by.x="chr.pos",by.y="chr.pos")
head(case_control_meta_result_final)
case_control_meta_result_final$chr.pos <- meta.chr.pos
shared.data <- merge(hap3,case_control_meta_result_final,by.x="chr.pos",by.y="chr.pos")
head(shared.data)
head(shared.onco.data.complete)
head(shared.icog.data.complete)
icog.onco.merge <- merge(shared.icog.data.complete,shared.onco.data.complete,by.x="chr.pos",by.y = "chr.pos")
head(icog.onco.merge)
n <- nrow(icog.onco.merge)
n
dim(shared.onco.data.complete)
head(shared.data)
shared.data.meta <- shared.data[,c(1,2,5,6,7,10,11)]
head(shared.data.meta)
n <- nrow(shared.data.meta)
A1 <- rep(0,nrow(shared.data.meta))
A2 <- rep(0,nrow(shared.data.meta))
temp <- strsplit(shared.data.meta$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.meta$A1 <- A1
shared.data.meta$A2 <- A2
head(shared.data.meta)
shared.data.meta.complete <- omit(shared.data.meta)
shared.data.meta.complete <- omit.na(shared.data.meta)
shared.data.meta.complete <- na.omit(shared.data.meta)
head(shared.data.meta.complete)
icog.meta.merge <- merge(shared.data.meta.complete,shared.icog.data.complete,by.x="chr.pos",by.y="chr.pos")
head(icog.meta.merge)
dim(icog.meta.merge)
dim(shared.data.meta.complete)
shared.data.meta.complete.new <- merge(shared.data.meta.complete,shared.icog.data.complete,by.x="chr.pos",by.y="chr.pos")
head(shared.data.meta.complete.new)
colnaems(shared.icog.data.complete)
colnames(shared.icog.data.complete)
colnames(shared.data.meta.complete.new)
shared.data.meta.complete <- shared.data.meta.complete.new[,c(1,2,3,4,5,14,6,7,8,9)]
head(shared.data.meta.complete)
colnames(shared.data.meta.complete) <- colnames(shared.icog.data.complete)
head(shared.data.meta.complete)
save(shared.data.meta.complete,file="/genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/ICOG/shared.data.meta.complete.Rdata")
save(shared.data.meta.complete,file="/genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/meta/shared.data.meta.complete.Rdata")
save(shared.data.meta.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/meta/shared.data.meta.complete.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/ER+_control/ICOG/icog_result_odds_sd.Rdata")
head(icog_result)
dim(icog_reuslt)
dim(icog_result)
icog_result$chr.pos <- icog.chr.pos
icog_new <- merge(hap3,icog_result,by.x="chr.pos",by.y = "chr.pos")
shared.data.icog <- icog_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.icog)
n <- nrow(shared.data.icog)
A1 <- rep(0,nrow(shared.data.icog))
A2 <- rep(0,nrow(shared.data.icog))
temp <- strsplit(shared.data.icog$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.icog$A1 <- A1
shared.data.icog$A2 <- A2
shared.icog.data.complete <- na.omit(shared.data.icog)
save(shared.icog.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER+_control/icog/shared.icog.data.complete.Rdata")
dim(shared.icog.data.complete)
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/ER+_control/ONCO/onco_result_odds_sd.Rdata")
onco_result$chr.pos <- onco.chr.pos
onco_new <- merge(hap3,onco_result,by.x="chr.pos",by.y = "chr.pos")
shared.data.onco <- onco_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.onco)
n <- nrow(shared.data.onco)
A1 <- rep(0,nrow(shared.data.onco))
A2 <- rep(0,nrow(shared.data.onco))
temp <- strsplit(shared.data.onco$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.onco$A1 <- A1
shared.data.onco$A2 <- A2
shared.onco.data.complete <- na.omit(shared.data.onco)
save(shared.onco.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER+_control/ONCO/shared.onco.data.complete.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/ER+_control/meta/case_control_meta_result_final.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/ER+_control/meta/ER+_control_meta_result_final.Rdata")
ls()
dim(ERPos_control_meta_result_final)
length(meta.chr.pos)
ERPos_control_meta_result_final$chr.pos <- meta.chr.pos
#save(meta.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/meta/meta.chr.pos.Rdata")
shared.data <- merge(hap3,ERPos_control_meta_result_final,by.x="chr.pos",by.y="chr.pos")
shared.data.meta <- shared.data[,c(1,2,5,6,7,10,11)]
head(shared.data.meta)
n <- nrow(shared.data.meta)
A1 <- rep(0,nrow(shared.data.meta))
A2 <- rep(0,nrow(shared.data.meta))
temp <- strsplit(shared.data.meta$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.meta$A1 <- A1
shared.data.meta$A2 <- A2
shared.data.meta.complete <- na.omit(shared.data.meta)
shared.data.meta.complete.new <- merge(shared.data.meta.complete,shared.icog.data.complete,by.x="chr.pos",by.y="chr.pos")
shared.data.meta.complete <- shared.data.meta.complete.new[,c(1,2,3,4,5,14,6,7,8,9)]
colnames(shared.data.meta.complete) <- colnames(shared.icog.data.complete)
head(shared.data.meta.complete)
save(shared.data.meta.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER+_control/meta/shared.data.meta.complete.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/ER-_control/ICOG/icog_result_odds_sd.Rdata")
icog_result$chr.pos <- icog.chr.pos
icog_new <- merge(hap3,icog_result,by.x="chr.pos",by.y = "chr.pos")
shared.data.icog <- icog_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.icog)
n <- nrow(shared.data.icog)
A1 <- rep(0,nrow(shared.data.icog))
A2 <- rep(0,nrow(shared.data.icog))
temp <- strsplit(shared.data.icog$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.icog$A1 <- A1
shared.data.icog$A2 <- A2
shared.icog.data.complete <- na.omit(shared.data.icog)
save(shared.icog.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER-_control/icog/shared.icog.data.complete.Rdata")
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/ER-_control/ONCO/onco_result_odds_sd.Rdata")
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/ER-_control/ONCO/onco_result_odds_sd.Rdata")
onco_result$chr.pos <- onco.chr.pos
onco_new <- merge(hap3,onco_result,by.x="chr.pos",by.y = "chr.pos")
shared.data.onco <- onco_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.onco)
n <- nrow(shared.data.onco)
A1 <- rep(0,nrow(shared.data.onco))
A2 <- rep(0,nrow(shared.data.onco))
temp <- strsplit(shared.data.onco$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.onco$A1 <- A1
shared.data.onco$A2 <- A2
shared.onco.data.complete <- na.omit(shared.data.onco)
save(shared.onco.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER-_control/ONCO/shared.onco.data.complete.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/ER-_control/meta/ER-_control_meta_result_final.Rdata")
ERNeg_control_meta_result_final$chr.pos <- meta.chr.pos
#save(meta.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/meta/meta.chr.pos.Rdata")
shared.data <- merge(hap3,ERNeg_control_meta_result_final,by.x="chr.pos",by.y="chr.pos")
shared.data.meta <- shared.data[,c(1,2,5,6,7,10,11)]
head(shared.data.meta)
n <- nrow(shared.data.meta)
A1 <- rep(0,nrow(shared.data.meta))
A2 <- rep(0,nrow(shared.data.meta))
temp <- strsplit(shared.data.meta$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.meta$A1 <- A1
shared.data.meta$A2 <- A2
shared.data.meta.complete <- na.omit(shared.data.meta)
shared.data.meta.complete.new <- merge(shared.data.meta.complete,shared.icog.data.complete,by.x="chr.pos",by.y="chr.pos")
shared.data.meta.complete <- shared.data.meta.complete.new[,c(1,2,3,4,5,14,6,7,8,9)]
colnames(shared.data.meta.complete) <- colnames(shared.icog.data.complete)
save(shared.data.meta.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER-_control/meta/shared.data.meta.complete.Rdata")
36/51
31/56
56*0.618
log.odds.mix <- rho*log.odds.meta.two.stage[,5]+(1-rho)*log.odds.meta
30+550-30
1070、2
1070、2
1070/2
exp(-0.294)
exp(0.073)
-2.85+0.049+0.055*1.5
exp(-2.71)
1、12
1/12
15/16
7/8
-3.433987+1.875843
exp(-3.433987+1.875843)
exp(-3.433987)
