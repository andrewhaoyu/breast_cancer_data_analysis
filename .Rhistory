scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
#scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fb9a99","chartreuse4","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#984ea3","#EF7E3D","#c0392b")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
library(ggplot2)
p <- list()
for(k in 1:length(select.names)){
data.temp <- data[,c(1:2,k+2)]
colnames(data.temp) <- c("quantile","method","or")
print({
png(file = paste0("./risk_prediction/Nasim_new_prs/result/",names.subtypes[k],".png"),width=8,height =6,unit = "in",res=300)
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
}
)
dev.off()
}
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#EF7E3D","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#EF7E3D","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fb9a99","chartreuse4","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#984ea3","#EF7E3D","#c0392b")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#EF7E3D","chartreuse4","#fb9a99","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#984ea3","#c0392b")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fb9a99","#EF7E3D","chartreuse4","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#984ea3","#c0392b")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fdb462","#7fc97f","#ef3b2c","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fb9a99","#EF7E3D","chartreuse4","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#984ea3","#c0392b")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fb9a99","chartreuse4","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#984ea3","#c0392b","#EF7E3D")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#EF7E3D","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#EF7E3D","chartreuse4","#7fc97f","#004953","#662506","#a6cee3","#fb9a99","#984ea3","#ffff33")), ...)
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
library(ggplot2)
p <- list()
for(k in 1:length(select.names)){
data.temp <- data[,c(1:2,k+2)]
colnames(data.temp) <- c("quantile","method","or")
print({
png(file = paste0("./risk_prediction/Nasim_new_prs/result/",names.subtypes[k],".png"),width=8,height =6,unit = "in",res=300)
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
}
)
dev.off()
}
png(file = paste0("./risk_prediction/Nasim_new_prs/result/",names.subtypes[k],".png"),width=10,height =6,unit = "in",res=300)
for(k in 1:length(select.names)){
data.temp <- data[,c(1:2,k+2)]
colnames(data.temp) <- c("quantile","method","or")
print({
png(file = paste0("./risk_prediction/Nasim_new_prs/result/",names.subtypes[k],".png"),width=10,height =6,unit = "in",res=300)
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
}
)
dev.off()
}
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))+
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))+
theme(axis.text.x = element_text(angle = 60, hjust = 1))
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
library(ggplot2)
p <- list()
for(k in 1:length(select.names)){
data.temp <- data[,c(1:2,k+2)]
colnames(data.temp) <- c("quantile","method","or")
print({
png(file = paste0("./risk_prediction/Nasim_new_prs/result/",names.subtypes[k],".png"),width=10,height =6,unit = "in",res=300)
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
}
)
dev.off()
}
setwd("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis")
odds.ratio <- read.csv("./risk_prediction/Nasim_new_prs/result/odds.ratio.csv")
odds.ratio.overall <- read.csv("./risk_prediction/Nasim_prs/result/odds.ratio.overall.csv")
odds.ratio.er <- read.csv("./risk_prediction/Nasim_prs/result/odds.ratio.er.csv")
quantile.thres <- factor(c("<1%","1%-5%","5%-10%",
"10%-20%","20%-40%","40%-60%","60%-80%","80%-90%","90%-95%","95%-99%",">99%"))
quantile.thres <- factor(quantile.thres,levels(quantile.thres)[c(1,3,7,4,5,6,8,9,10,11,2)])
n <- nrow(odds.ratio)
odds.ratio <- odds.ratio[,-1,drop=F]
method <- rep("Intrinsic subtyeps PRS")
odds.ratio <- cbind(quantile.thres,method,odds.ratio)
odds.ratio.overall <- odds.ratio.overall[,-1,drop=F]
method <- rep("Overall PRS",n)
odds.ratio.overall <- cbind(quantile.thres,method,odds.ratio.overall)
odds.ratio.er <- odds.ratio.er[,-1,drop=F]
method <- rep("ER specific PRS",n)
odds.ratio.er <- cbind(quantile.thres,method,odds.ratio.er)
select.names <- c("Luminal A-like ",
"Luminal B-like",
"Luminal B/HER2-negative-like",
" HER2-enriched-like",
"TN")
names.subtypes <-  c("Luminal_A",
"Luminal_B",
"Luminal_B_HER2Neg",
"HER2_Enriched",
"TN")
data <- rbind(odds.ratio,odds.ratio.overall,
odds.ratio.er)
scale_colour_Publication <- function(...){
library(scales)
discrete_scale("colour","Publication",manual_pal(values = c("#386cb0","#fb9a99","chartreuse4","#FFD042","#7fc97f","#004953","#662506","#a6cee3","#984ea3","#EF7E3D","#c0392b")), ...)
}
library(ggplot2)
p <- list()
for(k in 1:length(select.names)){
data.temp <- data[,c(1:2,k+2)]
colnames(data.temp) <- c("quantile","method","or")
print({
png(file = paste0("./risk_prediction/Nasim_new_prs/result/",names.subtypes[k],".png"),width=10,height =6,unit = "in",res=300)
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))+
theme(axis.text.x = element_text(angle = 30, hjust = 1))
}
)
dev.off()
}
png(file = paste0("./risk_prediction/Nasim_new_prs/result/",names.subtypes[k],".png"),width=10,height =6,unit = "in",res=300)
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
for(k in 1:length(select.names)){
data.temp <- data[,c(1:2,k+2)]
colnames(data.temp) <- c("quantile","method","or")
print({
png(file = paste0("./risk_prediction/Nasim_new_prs/result/",names.subtypes[k],".png"),width=10,height =6,unit = "in",res=300)
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))
}
)
dev.off()
}
p <- list()
for(k in 1:length(select.names)){
data.temp <- data[,c(1:2,k+2)]
colnames(data.temp) <- c("quantile","method","or")
print({
png(file = paste0("./risk_prediction/Nasim_new_prs/result/",names.subtypes[k],".png"),width=10,height =6,unit = "in",res=300)
ggplot(data.temp,aes(x=quantile,
y= or,group=method,color=method))+
geom_line(size=0.9)+
theme_Publication()+
scale_colour_Publication()+
xlab(NULL)+
ylab("Odds ratio")+
ggtitle(paste0(select.names[k]))+
scale_y_continuous(limits=(c(0,6)),
breaks= c(0,1,2,4,6))+
theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
)
dev.off()
}
n <- nrow(intrinsic_subtypes_result)
temp.str <- strsplit(intrinsic_subtypes_result$var_name,by="_")
?strsplit
temp.str <- strsplit(intrinsic_subtypes_result$var_name,split="_")
setwd("/data/zhangh24/breast_cancer_data_analysis/")
library(qqman)
install.packages("qqman")
library(qqman)
library(qqman)
library(qqman)
getwd()
load("./known_SNPs/known_SNPs_analysis_G_revised/batch_effect_test/result/permutate_genoytp_result.rdata")
result
head(result)
p <- c(result[,2],
result[,4],
result[,6],
result[,8])
head(p)
p
n <- length(p)
n
SNP <- paste0("rs",c(1:n))
n <- length(p)
n <- length(p)
n <- length(p)
n <- length(p)
n <- length(p)
SNP <- paste0("rs",c(1:n))
CHR <- rep(1,n)
Bp <- c(1,n)
n <- length(p)
SNP <- paste0("rs",c(1:n))
CHR <- rep(1,n)
Bp <- c(1,n)
gwas_result <- data.frame(SNP,CHR,BP,p)
BP <- c(1,n)
gwas_result <- data.frame(SNP,CHR,BP,p)
gwas_result <- data.frame(SNP,CHR,BP,p)
n <- length(p)
SNP <- paste0("rs",c(1:n))
CHR <- rep(1,n)
BP <- c(1,n)
gwas_result <- data.frame(SNP,CHR,BP,p)
qq(gwas_result$p)
png(filename = "./known_SNPs/known_SNPs_analysis_G_revised/batch_effect_test/result/permuate_genotype.png",width = 8,height = 6, unit = "in",
res = 300)
qq(gwas_result$p)
dev.off()
library(qqman)
load("./known_SNPs/known_SNPs_analysis_G_revised/batch_effect_test/result/permutate_genoytp_result.rdata")
head(result)
p <- c(result[,4],
result[,6],
result[,8],
result[,10])
n <- length(p)
SNP <- paste0("rs",c(1:n))
CHR <- rep(1,n)
BP <- c(1,n)
gwas_result <- data.frame(SNP,CHR,BP,p)
png(filename = "./known_SNPs/known_SNPs_analysis_G_revised/batch_effect_test/result/permuate_genotype.png",width = 8,height = 6, unit = "in",
res = 300)
qq(gwas_result$p)
dev.off()
#plot all phenotype results
load("./known_SNPs/known_SNPs_analysis_G_revised/batch_effect_test/result/permutate_phenotype_result.rdata")
p <- c(result[,4],
result[,6],
result[,8],
result[,10])
n <- length(p)
SNP <- paste0("rs",c(1:n))
CHR <- rep(1,n)
BP <- c(1,n)
gwas_result <- data.frame(SNP,CHR,BP,p)
qq(gwas_result$p)
gwas_result
min(gwas_result)
min(gwas_result$p)
#plot all phenotype results
load("./known_SNPs/known_SNPs_analysis_G_revised/batch_effect_test/result/permutate_phenotype_result.rdata")
p <- c(result[,4],
result[,6],
result[,8],
result[,10])
n <- length(p)
SNP <- paste0("rs",c(1:n))
CHR <- rep(1,n)
BP <- c(1,n)
gwas_result <- data.frame(SNP,CHR,BP,p)
png(filename = "./known_SNPs/known_SNPs_analysis_G_revised/batch_effect_test/result/permuate_phenotypes.png",width = 8,height = 6, unit = "in",
res = 300)
qq(gwas_result$p)
dev.off()
?heatmap
16/53
300*0.06
18*6
400*0.06
total <- 0
5166.67*12
data = read.csv("/Users/zhangh24/Desktop/FTOP_global_heterogeneity.csv")
head(data)
idx <- which(data[,3]<=0.05)
idx
length(idx)
jdx <- which(data[,3]<=0.05&data[,4]<=0.05)
length(jdx)
