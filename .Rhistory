#p.mat = p.value,
#insig = "label_sig",
#low=as.matrix(correlation.matrix.low),
#upp= as.matrix(correlation.matrix.high),
#rect.col = "navy", plotC = "rect", cl.pos = "n",
#col = my.color,
# method = "color",
addrect=2,
tl.col = "black",
#tl.srt = 30,
cl.lim = c(0, 1),
#sig.level = c(0.005,0.01,0.05),
pch.cex = .9, pch.col = "white"
)
corrplot(as.matrix(correlation.matrix),
method = "circle",
#p.mat = p.value,
#insig = "label_sig",
#low=as.matrix(correlation.matrix.low),
#upp= as.matrix(correlation.matrix.high),
#rect.col = "navy", plotC = "rect", cl.pos = "n",
#col = my.color,
# method = "color",
addrect=2,
order = "hclust"
tl.col = "black",
#tl.srt = 30,
cl.lim = c(0, 1),
#sig.level = c(0.005,0.01,0.05),
pch.cex = .9, pch.col = "white"
)
corrplot(as.matrix(correlation.matrix),
method = "circle",
#p.mat = p.value,
#insig = "label_sig",
#low=as.matrix(correlation.matrix.low),
#upp= as.matrix(correlation.matrix.high),
#rect.col = "navy", plotC = "rect", cl.pos = "n",
#col = my.color,
# method = "color",
addrect=2,
order = "hclust",
tl.col = "black",
#tl.srt = 30,
cl.lim = c(0, 1),
#sig.level = c(0.005,0.01,0.05),
pch.cex = .9, pch.col = "white"
)
corrplot(as.matrix(correlation.matrix),
method = "circle",
#p.mat = p.value,
#insig = "label_sig",
#low=as.matrix(correlation.matrix.low),
#upp= as.matrix(correlation.matrix.high),
#rect.col = "navy", plotC = "rect", cl.pos = "n",
#col = my.color,
# method = "color",
addrect=2,
order = "hclust",
tl.col = "black",
#tl.srt = 30,
cl.lim = c(0, 1),
#sig.level = c(0.005,0.01,0.05),
pch.cex = .9, pch.col = "white"
)
corrplot(as.matrix(correlation.matrix),
method = "circle",
#p.mat = p.value,
#insig = "label_sig",
#low=as.matrix(correlation.matrix.low),
#upp= as.matrix(correlation.matrix.high),
#rect.col = "navy", plotC = "rect", cl.pos = "n",
#col = my.color,
# method = "color",
addrect=2,
order = "hclust",
tl.col = "black",
tl.srt = 30,
cl.lim = c(0, 1),
#sig.level = c(0.005,0.01,0.05),
pch.cex = .9, pch.col = "white"
)
correlation.matrix
intrinsic_result
colnames(correlation.matrix) <- c("HR+, HER2-, low grade",
"HR+, HER2-, high grade",
"HR+, HER2+",
"HR-, HER2+",
"HR-, HER2-")
rownames(correlation.matrix) <- c("HR+, HER2-, low grade",
"HR+, HER2-, high grade",
"HR+, HER2+",
"HR-, HER2+",
"HR-, HER2-")
corrplot(as.matrix(correlation.matrix),
method = "circle",
#p.mat = p.value,
#insig = "label_sig",
#low=as.matrix(correlation.matrix.low),
#upp= as.matrix(correlation.matrix.high),
#rect.col = "navy", plotC = "rect", cl.pos = "n",
#col = my.color,
# method = "color",
addrect=2,
order = "hclust",
tl.col = "black",
tl.srt = 30,
cl.lim = c(0, 1),
#sig.level = c(0.005,0.01,0.05),
pch.cex = .9, pch.col = "white"
)
png(filename="meta_heatmap_two_stage.png",width=10,heigh=10,units="in",res=600)
colnames(correlation.matrix) <- c("HR+, HER2-, low grade",
"HR+, HER2-, high grade",
"HR+, HER2+",
"HR-, HER2+",
"HR-, HER2-")
rownames(correlation.matrix) <- c("HR+, HER2-, low grade",
"HR+, HER2-, high grade",
"HR+, HER2+",
"HR-, HER2+",
"HR-, HER2-")
corrplot(as.matrix(correlation.matrix),
method = "circle",
#p.mat = p.value,
#insig = "label_sig",
#low=as.matrix(correlation.matrix.low),
#upp= as.matrix(correlation.matrix.high),
#rect.col = "navy", plotC = "rect", cl.pos = "n",
#col = my.color,
# method = "color",
addrect=2,
order = "hclust",
tl.col = "black",
tl.srt = 30,
cl.lim = c(0, 1),
#sig.level = c(0.005,0.01,0.05),
pch.cex = .9, pch.col = "white"
)
# heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
#           main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
dev.off()
ggplot(cor.data,aes(x=subtypes.f,y=cor.vec))+
geom_point(size=4)+
geom_errorbar(aes(ymax = cor.vec.high, ymin = cor.vec.low))+
theme_minimal()+  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Genetic correlation") +
ggtitle("Genetic correlation between five intrinsic subtypes")  +
theme(text = element_text(size=10),plot.title = element_text(hjust = 0.5,face = "bold"),axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold.italic"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"))+
xlab("Intrinsic subtypes")+
scale_y_continuous(limits=c(0,1))+
coord_flip()
library(ggplot2)
ggplot(cor.data,aes(x=subtypes.f,y=cor.vec))+
geom_point(size=4)+
geom_errorbar(aes(ymax = cor.vec.high, ymin = cor.vec.low))+
theme_minimal()+  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Genetic correlation") +
ggtitle("Genetic correlation between five intrinsic subtypes")  +
theme(text = element_text(size=10),plot.title = element_text(hjust = 0.5,face = "bold"),axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold.italic"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"))+
xlab("Intrinsic subtypes")+
scale_y_continuous(limits=c(0,1))+
coord_flip()
#get results for CIMBA+ BCAC
setwd("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/result/")
intrinsic_result <- read.csv("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/result/CIMBA_BCAC.csv",header=F)
correlation.matrix <- intrinsic_result[1:5,2:6]
correlation.matrix.se <- intrinsic_result[6:10,2:6]
correlation.matrix <- correlation.matrix[c(2,5,4,3,1),c(2,5,4,3,1)]
correlation.matrix.se <- correlation.matrix.se[c(2,5,4,3,1),c(2,5,4,3,1)]
correlation.95 <- get_cor_95(correlation.matrix,correlation.matrix.se)
names <- as.character(intrinsic_result[c(2,5,4,3,1),1])
colnames(correlation.matrix) <- names
rownames(correlation.matrix) <- names
colnames(correlation.95) <- names
rownames(correlation.95) <- names
correlation.matrix.low <- get_cor_95_list(correlation.matrix,correlation.matrix.se)[[1]]
correlation.matrix.high<- get_cor_95_list(correlation.matrix,correlation.matrix.se)[[2]]
p.value<- get_cor_95_list(correlation.matrix,correlation.matrix.se)[[3]]
M <- nrow(correlation.matrix)
combn.list <- combn(M,2)
n <- ncol(combn.list)
cor.vec.high <- cor.vec.low <- cor.vec <- rep(0,n)
subtypes <- rep("c",n)
names <- c("HR+, HER2-, low grade",
"HR+, HER2-, high grade",
"HR+, HER2+",
"HR-, HER2+",
"HR-, HER2-")
for(i in n:1){
subtypes[i] <- paste0(names[combn.list[1,i]],
" vs ",
names[combn.list[2,i]])
cor.vec[i] <- correlation.matrix[combn.list[2,i],combn.list[1,i]]
cor.vec.low[i] <- correlation.matrix.low[combn.list[2,i],combn.list[1,i]]
cor.vec.high[i] <- correlation.matrix.high[combn.list[2,i],combn.list[1,i]]
}
subtypes.f <- factor(subtypes,levels=subtypes)
cor.data <-data.frame(subtypes.f,cor.vec,
cor.vec.low,
cor.vec.high)
cor.data <- cor.data[order(cor.data[,2]),]
cor.data[,1] <- factor(cor.data[,1],
levels=as.character(cor.data[,1]))
library(ggplot2)
ggplot(cor.data,aes(x=subtypes.f,y=cor.vec))+
geom_point(size=4)+
geom_errorbar(aes(ymax = cor.vec.high, ymin = cor.vec.low))+
theme_minimal()+  theme(axis.text.x = element_text(angle = 90, hjust = 1)) + ylab("Genetic correlation") +
ggtitle("Genetic correlation between five intrinsic subtypes")  +
theme(text = element_text(size=10),plot.title = element_text(hjust = 0.5,face = "bold"),axis.text.x = element_text(face = "bold"),
axis.text.y = element_text(face = "bold.italic"),
axis.title.x = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"))+
xlab("Intrinsic subtypes")+
scale_y_continuous(limits=c(0,1))+
coord_flip()
library(corrplot)
pal.breaks <- seq(0.5,1,0.01)
col <- colorRampPalette(c("white","red"))(length(pal.breaks)-1)
# heatmap(correlation.matrix,col = col,symm=T,margins=c(10,4),key.title="",key.ylab="",cexRow=1,cexCol=1)
paletteLength <- 50
my.color <- colorRampPalette(c("white", "dodgerblue4"))(paletteLength)
myBreaks <- c(seq(0, max(correlation.matrix), length.out=floor(paletteLength)))
png(filename="meta_heatmap_two_stage.png",width=10,heigh=10,units="in",res=600)
colnames(correlation.matrix) <- c("HR+, HER2-, low grade",
"HR+, HER2-, high grade",
"HR+, HER2+",
"HR-, HER2+",
"HR-, HER2-")
rownames(correlation.matrix) <- c("HR+, HER2-, low grade",
"HR+, HER2-, high grade",
"HR+, HER2+",
"HR-, HER2+",
"HR-, HER2-")
corrplot(as.matrix(correlation.matrix),
method = "circle",
#p.mat = p.value,
#insig = "label_sig",
#low=as.matrix(correlation.matrix.low),
#upp= as.matrix(correlation.matrix.high),
#rect.col = "navy", plotC = "rect", cl.pos = "n",
#col = my.color,
# method = "color",
addrect=2,
order = "hclust",
tl.col = "black",
tl.srt = 30,
cl.lim = c(0, 1),
#sig.level = c(0.005,0.01,0.05),
pch.cex = .9, pch.col = "white"
)
# heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
#           main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
dev.off()
25+7+5+4+9+14
62.13-46.78
GenA_G_B <- function(B){
p1= 0.8
p2 = 0.6
if(B==0){
A = rbinom(1,1,p1)
}else{
A = rbinom(1,1,p2)
}
return(A)
}
GenB_G_A <- function(A){
p1= 2/3
p2 = 3/7
if(A==0){
B = rbinom(1,1,p1)
}else{
B = rbinom(1,1,p2)
}
return(B)
}
n <- 1000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
A_r
B_r
result <- cbind(A,B)
result <- cbind(A_r,B_r)
result <- result[n/2:(n-1),]
hist(result)
table(result[,1],result[,2])
table(result[,1],result[,2])/(nrow(result))
n <- 10000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[n/2:(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
n <- 20000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[n/2:(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
n <- 30000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[n/2:(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
GenA_G_B <- function(B){
p1= 0.8
p2 = 0.4
if(B==0){
A = rbinom(1,1,p1)
}else{
A = rbinom(1,1,p2)
}
return(A)
}
GenB_G_A <- function(A){
p1= 3/4
p2 = 1/3
if(A==0){
B = rbinom(1,1,p1)
}else{
B = rbinom(1,1,p2)
}
return(B)
}
n <- 1000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[n/2:(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
rbinom(1,1,1)
rbinom(1,1,0)
rbinom(10,1,0)
rbinom(10,1,0.1)
rbinom(100,1,0.1)
sum(rbinom(100,1,0.1))
head(result)
n <- 10000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[n/2:(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
GenA_G_B <- function(B){
p1= 0.8
p2 = 0.4
if(B==0){
A = rbinom(1,1,p1)
}else if(B==1){
A = rbinom(1,1,p2)
}
return(A)
}
GenB_G_A <- function(A){
p1= 3/4
p2 = 1/3
if(A==0){
B = rbinom(1,1,p1)
}else if(A==1){
B = rbinom(1,1,p2)
}
return(B)
}
n <- 10000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[n/2:(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
n <- 20000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[n/2:(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
dim(result)
result <- cbind(A_r,B_r)
result <- result[n/2:(n-1),]
dim(result)
result <- result[(n/2):(n-1),]
result <- cbind(A_r,B_r)
result <- result[(n/2):(n-1),]
dim(result)
#hist(result)
table(result[,1],result[,2])/(nrow(result))
n <- 10000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[(n/2):(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
n <- 10000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[(n/2):(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
n <- 1000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[(n/2):(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
n <- 10000
A_r <- rep(0,n)
B_r <- rep(0,n)
for(i in 1:(n-1)){
A_r[i] <- GenA_G_B(B_r[i])
B_r[i+1] <- GenB_G_A(A_r[i])
}
result <- cbind(A_r,B_r)
result <- result[(n/2):(n-1),]
#hist(result)
table(result[,1],result[,2])/(nrow(result))
8*7+8*5
162-96
168-96
x=rep(0,100,1,100,2,100)
y = c(rnorm(0,100),rnorm(1,100),rnorm(2,100))
plot(x,y)
x=rep(0,100,1,100,2,100)
y = c(rnorm(100,0),rnorm(100,1),rnorm(100,2))
plot(x,y)
x=c(rep(0,100),rep(1,100),rep(2,100))
y = c(rnorm(100,0),rnorm(100,1),rnorm(100,2))
plot(x,y)
n <- 200
x=c(rep(0,n),rep(1,n),rep(2,n))
y = c(rnorm(n,0),rnorm(n,1),rnorm(n,2))
plot(x,y)
(1100+60-182)/2
a=1
b=1
x = seq(-1,1,0.01)
y = a/(x^3+2*x^2-1)+b/(x^3+x-2)
plot(x,y)
a=1
b=2
x = seq(-1,1,0.01)
y = a/(x^3+2*x^2-1)+b/(x^3+x-2)
plot(x,y)
a=1
b=3
x = seq(-1,1,0.01)
y = a/(x^3+2*x^2-1)+b/(x^3+x-2)
plot(x,y)
a=2
b=3
x = seq(-1,1,0.01)
y = a/(x^3+2*x^2-1)+b/(x^3+x-2)
plot(x,y)
0.5/3
