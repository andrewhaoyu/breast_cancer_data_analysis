shared.data.icog$A2 <- A2
head(shared.data.icog)
try <- matrix(0,3,3)
try
tyr[2,1] <- NA
try[2,1] <- NA
try[3,2] <- NA
try
complete(try)
library(tidyverse)
complete(try)
complete(try,c(1,2))
try <- as.data.frame(try)
head(try)
complete(try)
complete(try,c(1,2))
complete.cases(try)
na.omit(try)
shared.icog.data.complete <- complete.cases(shared.data.icog)
head(shared.icog.data.complete)
shared.icog.data.complete <- na.omit(shared.data.icog)
dim(shared.icog.data.complete)
head(shared.icog.data.complete)
setwd("/Users/zhangh24/GoogleDrive/")
setwd("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/")
save(shared.icog.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/ICOG/shared.icog.data.complete.Rdata")
head(onco_result)
setwd("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/")
library(data.table)
hap3 <- fread("./data/HM3snplist_withCHRBP.txt",header=T)
dim(hap3)
CHR_generate <- function(position){
n <- length(position)
CHR <- rep(22,n)
position.diff <- diff(position)
idx <- which(position.diff<0)
start <- 1
temp <- 1
for(i in 1:length(idx)){
end <- idx[i]
CHR[start:end] <- temp
start <- end+1
temp = temp+1
}
return(CHR)
}
hap3.chr.bp <- cbind(hap3[,4],hap3[,5])
hap3.chr.bp.uni <- apply(hap3.chr.bp,1,paste0,collapse = ":")
dim(hap3)
length(hap3.chr.bp.uni)
hap3$chr.pos <- hap3.chr.bp.uni
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/ICOG/icog_result_odds_sd.Rdata")
CHR <- CHR_generate(icog_result$position)
icog_result.chr <- CHR
icog.chr.bp <- cbind(icog_result.chr,icog_result$position)
icog.chr.pos <- apply(icog.chr.bp,1,paste0,collapse=":")
icog_result$chr.pos <- icog.chr.pos
save(icog.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/ICOG/icog.chr.pos.Rdata")
head(icog_new)
colnames(icog_new)
shared.data.icog <- icog_new[,c(1,2,5,6,8,11,18,19)]
head(shared.data.icog)
shared.data.icog <- icog_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.icog)
n <- nrow(shared.data.icog)
A1 <- rep(0,nrow(shared.data.icog))
A2 <- rep(0,nrow(shared.data.icog))
temp <- strsplit(shared.data.icog$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.icog$A1 <- A1
shared.data.icog$A2 <- A2
head(shared.data.icog)
shared.icog.data.complete <- na.omit(shared.data.icog)
head(shared.icog.data.complete)
dim(shared.icog.data.complete)
save(shared.icog.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/ICOG/shared.icog.data.complete.Rdata")
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/ONCO/onco_result_odds_sd.Rdata")
head(onco_result)
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/ONCO/onco_result_odds_sd.Rdata")
CHR <- CHR_generate(onco_result$position)
onco_result.chr <- CHR
onco.chr.bp <- cbind(onco_result.chr,onco_result$position)
onco.chr.pos <- apply(onco.chr.bp,1,paste0,collapse=":")
onco_result$chr.pos <- onco.chr.pos
save(onco.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/onco/onco.chr.pos.Rdata")
onco_new <- merge(hap3,onco_result,by.x="chr.pos",by.y = "chr.pos")
head(onco_new)
colnames(onco_new)
shared.data.onco <- onco_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.onco)
head(shared.data.icog)
n <- nrow(shared.data.onco)
A1 <- rep(0,nrow(shared.data.onco))
A2 <- rep(0,nrow(shared.data.onco))
temp <- strsplit(shared.data.onco$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.onco$A1 <- A1
shared.data.onco$A2 <- A2
shared.onco.data.complete <- na.omit(shared.data.onco)
dim(shared.onco.data.complete)
dim(shared.icog.data.complete)
head(shared.data.onco)
head(shared.data.icog)
save(shared.onco.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/ONCO/shared.onco.data.complete.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/meta/case_control_meta_result_final.Rdata")
head(case_control_meta_result_final)
dim(case_control_meta_result_final)
length(bcac.chr.bp.uni)
meta.chr.bp <- bcac.chr.bp.uni
save(meta.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/meta/meta.chr.pos.Rdata")
meta.chr.pos <- meta.chr.bp
save(meta.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/meta/meta.chr.pos.Rdata")
shared.data <- merge(hap3,case_control_meta_result_final,by.x="chr.pos",by.y="chr.pos")
head(case_control_meta_result_final)
case_control_meta_result_final$chr.pos <- meta.chr.pos
shared.data <- merge(hap3,case_control_meta_result_final,by.x="chr.pos",by.y="chr.pos")
head(shared.data)
head(shared.onco.data.complete)
head(shared.icog.data.complete)
icog.onco.merge <- merge(shared.icog.data.complete,shared.onco.data.complete,by.x="chr.pos",by.y = "chr.pos")
head(icog.onco.merge)
n <- nrow(icog.onco.merge)
n
dim(shared.onco.data.complete)
head(shared.data)
shared.data.meta <- shared.data[,c(1,2,5,6,7,10,11)]
head(shared.data.meta)
n <- nrow(shared.data.meta)
A1 <- rep(0,nrow(shared.data.meta))
A2 <- rep(0,nrow(shared.data.meta))
temp <- strsplit(shared.data.meta$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.meta$A1 <- A1
shared.data.meta$A2 <- A2
head(shared.data.meta)
shared.data.meta.complete <- omit(shared.data.meta)
shared.data.meta.complete <- omit.na(shared.data.meta)
shared.data.meta.complete <- na.omit(shared.data.meta)
head(shared.data.meta.complete)
icog.meta.merge <- merge(shared.data.meta.complete,shared.icog.data.complete,by.x="chr.pos",by.y="chr.pos")
head(icog.meta.merge)
dim(icog.meta.merge)
dim(shared.data.meta.complete)
shared.data.meta.complete.new <- merge(shared.data.meta.complete,shared.icog.data.complete,by.x="chr.pos",by.y="chr.pos")
head(shared.data.meta.complete.new)
colnaems(shared.icog.data.complete)
colnames(shared.icog.data.complete)
colnames(shared.data.meta.complete.new)
shared.data.meta.complete <- shared.data.meta.complete.new[,c(1,2,3,4,5,14,6,7,8,9)]
head(shared.data.meta.complete)
colnames(shared.data.meta.complete) <- colnames(shared.icog.data.complete)
head(shared.data.meta.complete)
save(shared.data.meta.complete,file="/genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/ICOG/shared.data.meta.complete.Rdata")
save(shared.data.meta.complete,file="/genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/meta/shared.data.meta.complete.Rdata")
save(shared.data.meta.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/case_control/meta/shared.data.meta.complete.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/ER+_control/ICOG/icog_result_odds_sd.Rdata")
head(icog_result)
dim(icog_reuslt)
dim(icog_result)
icog_result$chr.pos <- icog.chr.pos
icog_new <- merge(hap3,icog_result,by.x="chr.pos",by.y = "chr.pos")
shared.data.icog <- icog_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.icog)
n <- nrow(shared.data.icog)
A1 <- rep(0,nrow(shared.data.icog))
A2 <- rep(0,nrow(shared.data.icog))
temp <- strsplit(shared.data.icog$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.icog$A1 <- A1
shared.data.icog$A2 <- A2
shared.icog.data.complete <- na.omit(shared.data.icog)
save(shared.icog.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER+_control/icog/shared.icog.data.complete.Rdata")
dim(shared.icog.data.complete)
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/ER+_control/ONCO/onco_result_odds_sd.Rdata")
onco_result$chr.pos <- onco.chr.pos
onco_new <- merge(hap3,onco_result,by.x="chr.pos",by.y = "chr.pos")
shared.data.onco <- onco_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.onco)
n <- nrow(shared.data.onco)
A1 <- rep(0,nrow(shared.data.onco))
A2 <- rep(0,nrow(shared.data.onco))
temp <- strsplit(shared.data.onco$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.onco$A1 <- A1
shared.data.onco$A2 <- A2
shared.onco.data.complete <- na.omit(shared.data.onco)
save(shared.onco.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER+_control/ONCO/shared.onco.data.complete.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/ER+_control/meta/case_control_meta_result_final.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/ER+_control/meta/ER+_control_meta_result_final.Rdata")
ls()
dim(ERPos_control_meta_result_final)
length(meta.chr.pos)
ERPos_control_meta_result_final$chr.pos <- meta.chr.pos
#save(meta.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/meta/meta.chr.pos.Rdata")
shared.data <- merge(hap3,ERPos_control_meta_result_final,by.x="chr.pos",by.y="chr.pos")
shared.data.meta <- shared.data[,c(1,2,5,6,7,10,11)]
head(shared.data.meta)
n <- nrow(shared.data.meta)
A1 <- rep(0,nrow(shared.data.meta))
A2 <- rep(0,nrow(shared.data.meta))
temp <- strsplit(shared.data.meta$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.meta$A1 <- A1
shared.data.meta$A2 <- A2
shared.data.meta.complete <- na.omit(shared.data.meta)
shared.data.meta.complete.new <- merge(shared.data.meta.complete,shared.icog.data.complete,by.x="chr.pos",by.y="chr.pos")
shared.data.meta.complete <- shared.data.meta.complete.new[,c(1,2,3,4,5,14,6,7,8,9)]
colnames(shared.data.meta.complete) <- colnames(shared.icog.data.complete)
head(shared.data.meta.complete)
save(shared.data.meta.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER+_control/meta/shared.data.meta.complete.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/ER-_control/ICOG/icog_result_odds_sd.Rdata")
icog_result$chr.pos <- icog.chr.pos
icog_new <- merge(hap3,icog_result,by.x="chr.pos",by.y = "chr.pos")
shared.data.icog <- icog_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.icog)
n <- nrow(shared.data.icog)
A1 <- rep(0,nrow(shared.data.icog))
A2 <- rep(0,nrow(shared.data.icog))
temp <- strsplit(shared.data.icog$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.icog$A1 <- A1
shared.data.icog$A2 <- A2
shared.icog.data.complete <- na.omit(shared.data.icog)
save(shared.icog.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER-_control/icog/shared.icog.data.complete.Rdata")
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/ER-_control/ONCO/onco_result_odds_sd.Rdata")
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/standard_analysis/result/standard_gwas_result/ER-_control/ONCO/onco_result_odds_sd.Rdata")
onco_result$chr.pos <- onco.chr.pos
onco_new <- merge(hap3,onco_result,by.x="chr.pos",by.y = "chr.pos")
shared.data.onco <- onco_new[,c(1,2,5,6,8,10,18,19)]
head(shared.data.onco)
n <- nrow(shared.data.onco)
A1 <- rep(0,nrow(shared.data.onco))
A2 <- rep(0,nrow(shared.data.onco))
temp <- strsplit(shared.data.onco$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.onco$A1 <- A1
shared.data.onco$A2 <- A2
shared.onco.data.complete <- na.omit(shared.data.onco)
save(shared.onco.data.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER-_control/ONCO/shared.onco.data.complete.Rdata")
load("./genetic_correlation/standard_analysis/result/standard_gwas_result/ER-_control/meta/ER-_control_meta_result_final.Rdata")
ERNeg_control_meta_result_final$chr.pos <- meta.chr.pos
#save(meta.chr.pos,file="./genetic_correlation/standard_analysis/result/standard_gwas_result/case_control/meta/meta.chr.pos.Rdata")
shared.data <- merge(hap3,ERNeg_control_meta_result_final,by.x="chr.pos",by.y="chr.pos")
shared.data.meta <- shared.data[,c(1,2,5,6,7,10,11)]
head(shared.data.meta)
n <- nrow(shared.data.meta)
A1 <- rep(0,nrow(shared.data.meta))
A2 <- rep(0,nrow(shared.data.meta))
temp <- strsplit(shared.data.meta$rs_id,":")
for(i in 1:n){
print(i)
A1[i] <- temp[[i]][3]
A2[i] <- temp[[i]][4]
}
shared.data.meta$A1 <- A1
shared.data.meta$A2 <- A2
shared.data.meta.complete <- na.omit(shared.data.meta)
shared.data.meta.complete.new <- merge(shared.data.meta.complete,shared.icog.data.complete,by.x="chr.pos",by.y="chr.pos")
shared.data.meta.complete <- shared.data.meta.complete.new[,c(1,2,3,4,5,14,6,7,8,9)]
colnames(shared.data.meta.complete) <- colnames(shared.icog.data.complete)
save(shared.data.meta.complete,file="./genetic_correlation/standard_analysis/result/standard_gwas_result_hapmap3/ER-_control/meta/shared.data.meta.complete.Rdata")
36/51
31/56
56*0.618
log.odds.mix <- rho*log.odds.meta.two.stage[,5]+(1-rho)*log.odds.meta
30+550-30
1070、2
1070、2
1070/2
exp(-0.294)
exp(0.073)
-2.85+0.049+0.055*1.5
exp(-2.71)
1、12
1/12
15/16
7/8
-3.433987+1.875843
exp(-3.433987+1.875843)
exp(-3.433987)
1600*7+1600*2+500*5
2000*7+1600*2+500*5
1041.67*9+162.7+2083.34+1200+2083.34+130.21
1041.67*9+162.7+2083.34+1200+2083.34+130.21+518.17+552.71*10
19201.30+2977.60
getwd()
discovery_snp <- read.csv("./data/discovery_snps_annotated_clean.csv",header=T)
head(discovery_snp)
class(discovery_snp)
discovery_snp <- read.csv("./data/discovery_snps_annotated_clean.csv",header=T)
head(discovery_snp)
discovery_snp <- fread("./data/discovery_snps_annotated_clean.csv",header=T)
library(data.table)
discovery_snp <- fread("./data/discovery_snps_annotated_clean.csv",header=T)
head(discovery_snp)
discovery_snp <- as.data.frame(fread("./data/discovery_snps_annotated_clean.csv",header=T))
head(discovery_snp)
fine_mapping <- as.data.frame(fread("./data/fine_mapping_annotated_clean.csv"))
head(fine_mapping)
discovery_snp
dim(fine_mapping)
head(fine_mapping)
dis <- 10^6
for(i in 11:29){
pos <- discovery_snp$position[i]
CHR <- discovery_snp$CHR[i]
for(j in 1:178){
pos.known <- fine_mapping$position[j]
CHR.known <- fine_mapping$CHR[i]
if(CHR==CHR.known&pos>=(pos.known-dis)&pos<=(pos.known+dis))
print(c(i,j))
}
}
discovery_snp[11,]
fine_mapping[c(4,22,127)]
fine_mapping[c(4,22,127),]
dis <- 10^6
for(i in 11:29){
pos <- discovery_snp$position[i]
CHR <- discovery_snp$CHR[i]
for(j in 1:178){
pos.known <- fine_mapping$position[j]
CHR.known <- fine_mapping$CHR[j]
if(CHR==CHR.known&pos>=(pos.known-dis)&pos<=(pos.known+dis))
print(c(i,j))
}
}
fine_mapping[4,]
discovery_snp[12,]
fine_mapping[59,]
discovery_snp[17,]
result <- rbind(discovery_snp[i,c(1,2,3)]
,fine_mapping[i,c(1,3,4)])
check.data <- NULL
dis <- 10^6
check.data <- NULL
for(i in 11:29){
pos <- discovery_snp$position[i]
CHR <- discovery_snp$CHR[i]
for(j in 1:178){
pos.known <- fine_mapping$position[j]
CHR.known <- fine_mapping$CHR[j]
if(CHR==CHR.known&pos>=(pos.known-dis)&pos<=(pos.known+dis))
print(c(i,j))
temp1 <- discovery_snp[i,c(1,2,3)]
colnames(temp1) <- c("SNP","CHR","Position")
temp2 <- fine_mapping[i,c(1,3,4)]
colnames(temp2) <- c("SNP","CHR","Position")
result <- rbind(temp1,temp2)
check.data <- rbind(check.data,result)
}
}
check.data
dis <- 10^6
check.data <- NULL
for(i in 11:29){
pos <- discovery_snp$position[i]
CHR <- discovery_snp$CHR[i]
for(j in 1:178){
pos.known <- fine_mapping$position[j]
CHR.known <- fine_mapping$CHR[j]
if(CHR==CHR.known&pos>=(pos.known-dis)&pos<=(pos.known+dis))
print(c(i,j))
temp1 <- discovery_snp[i,c(1,2,3)]
colnames(temp1) <- c("SNP","CHR","Position")
temp2 <- fine_mapping[j,c(1,3,4)]
colnames(temp2) <- c("SNP","CHR","Position")
result <- rbind(temp1,temp2)
check.data <- rbind(check.data,result)
}
}
check.data
dis <- 10^6
check.data <- NULL
for(i in 11:29){
pos <- discovery_snp$position[i]
CHR <- discovery_snp$CHR[i]
for(j in 1:178){
pos.known <- fine_mapping$position[j]
CHR.known <- fine_mapping$CHR[j]
if(CHR==CHR.known&pos>=(pos.known-dis)&pos<=(pos.known+dis))
print(c(i,j))
temp1 <- discovery_snp[i,c(1,2,3)]
colnames(temp1) <- c("SNP","CHR","Position")
temp2 <- fine_mapping[j,c(1,3,4)]
colnames(temp2) <- c("SNP","CHR","Position")
result <- rbind(temp1,temp2)
check.data <- rbind(check.data,result)
}
}
check.data
dis <- 10^6
check.data <- NULL
for(i in 11:29){
pos <- discovery_snp$position[i]
CHR <- discovery_snp$CHR[i]
for(j in 1:178){
pos.known <- fine_mapping$position[j]
CHR.known <- fine_mapping$CHR[j]
if(CHR==CHR.known&pos>=(pos.known-dis)&pos<=(pos.known+dis)){
print(c(i,j))
temp1 <- discovery_snp[i,c(1,2,3)]
colnames(temp1) <- c("SNP","CHR","Position")
temp2 <- fine_mapping[j,c(1,3,4)]
colnames(temp2) <- c("SNP","CHR","Position")
result <- rbind(temp1,temp2)
check.data <- rbind(check.data,result)
}
}
}
check.data
head(fine_mapping)
head(discovery_snp)
dis <- 10^6
check.data <- NULL
for(i in 11:29){
pos <- discovery_snp$position[i]
CHR <- discovery_snp$CHR[i]
for(j in 1:178){
pos.known <- fine_mapping$position[j]
CHR.known <- fine_mapping$CHR[j]
if(CHR==CHR.known&pos>=(pos.known-dis)&pos<=(pos.known+dis)){
print(c(i,j))
temp1 <- discovery_snp[i,c(1,3,2)]
colnames(temp1) <- c("SNP","CHR","Position")
temp2 <- fine_mapping[j,c(1,3,4)]
colnames(temp2) <- c("SNP","CHR","Position")
result <- rbind(temp1,temp2)
check.data <- rbind(check.data,result)
}
}
}
head(fine_mapping)
head(check.data)
dis <- 10^6
check.data <- NULL
for(i in 11:29){
pos <- discovery_snp$position[i]
CHR <- discovery_snp$CHR[i]
for(j in 1:178){
pos.known <- fine_mapping$position[j]
CHR.known <- fine_mapping$CHR[j]
if(CHR==CHR.known&pos>=(pos.known-dis)&pos<=(pos.known+dis)){
print(c(i,j))
temp1 <- discovery_snp[i,c(1,3,2)]
colnames(temp1) <- c("SNP","CHR","Position")
temp2 <- fine_mapping[j,c(1,3,4)]
colnames(temp2) <- c("SNP","CHR","Position")
result <- rbind(temp1,temp2)
check.data <- rbind(check.data,result)
}
}
}
check.data
write.csv(check.data,file="./data/check_SNPs.csv",row.names = F,col.names = T)
121280613-120485335
head(fine_mapping)
idx <- which(fine_mapping$Best.published.SNP=="rs72749841")
45939294-45374890
> 45939294-44706498
45939294-44706498
library(bc2)
?quantile
quantile(rnorm(100),probs=seq(0,1,0.1))
quantile(rnorm(100),probs=seq(0,1,0.1))[1]
cal.standard
750(1.21+1.19)
750*(1.21+1.19)
750*(1.21+0.19)
750/13
50*13
58*13
754*11.9
754*11.9/100
754*0.21
754+89.72+158.34
750/50
750*(1.21+0.19)
750*(1.21+0.11.9)
750*(1.21+0.119)
