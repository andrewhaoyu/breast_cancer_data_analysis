setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/ONCO_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
covariance.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix[i,j]-1.96*covariance.matrix.se[i,j],"-",covariance.matrix[i,j]+1.96*covariance.matrix.se[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,5,5)
#write.csv(covariance.matrix.new,file="./covariance_matrix_icog.csv",quote=F)
write.csv(correlation.matrix.new,file="./correlation_matrix_onco.csv",quote=F)
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
col <- colorRampPalette(c("white", "dodgerblue4"))(50)
# heatmap(correlation.matrix,col = col,symm=T,margins=c(10,4),key.title="",key.ylab="",cexRow=1,cexCol=1)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none")
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
rm(list=ls())
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/meta_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
covariance.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix[i,j]-1.96*covariance.matrix.se[i,j],"-",covariance.matrix[i,j]+1.96*covariance.matrix.se[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,5,5)
#write.csv(covariance.matrix.new,file="./covariance_matrix_icog.csv",quote=F)
write.csv(correlation.matrix.new,file="./correlation_matrix_meta.csv",quote=F)
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
col <- colorRampPalette(c("white", "dodgerblue4"))(50)
# heatmap(correlation.matrix,col = col,symm=T,margins=c(10,4),key.title="",key.ylab="",cexRow=1,cexCol=1)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none")
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/meta_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
correlation.matrix
rm(list=ls())
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/meta_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
covariance.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix[i,j]-1.96*covariance.matrix.se[i,j],"-",covariance.matrix[i,j]+1.96*covariance.matrix.se[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,5,5)
#write.csv(covariance.matrix.new,file="./covariance_matrix_icog.csv",quote=F)
write.csv(correlation.matrix.new,file="./correlation_matrix_meta.csv",quote=F)
#
# cluster.p <- as.dendrogram(hclust(d = dist(x = correlation.matrix)))
# ggdendrogram(data=cluster.p,rotate=F)
# library(ggcorrplot)
# ggcorrplot(correlation.matrix)
#
#
#
#
#
rm(list=ls())
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/ONCO_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
covariance.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix[i,j]-1.96*covariance.matrix.se[i,j],"-",covariance.matrix[i,j]+1.96*covariance.matrix.se[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
correlation.matrix
covariance.matrix
ldsc_result
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/ICOG_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
covariance.matrix
correlation.matrix
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/ONCO_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
correlation.matrix
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/meta_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/ICOG_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
covariance.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix[i,j]-1.96*covariance.matrix.se[i,j],"-",covariance.matrix[i,j]+1.96*covariance.matrix.se[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,5,5)
write.csv(covariance.matrix.new,file="./covariance_matrix_icog.csv",quote=F)
write.csv(correlation.matrix.new,file="./correlation_matrix_icog.csv",quote=F)
covariance.matrix.new
places <- 3
correlation.matrix
correlation.matrix <- round(correlation.matrix,places)
correlation.matrix.high <- round(correlation.matrix.high,places)
correlation.matrix.low <- round(correlation.matrix.low,places)
correlation.matrix.high <- round(correlation.matrix.high,places)
covariance.matrix.high <- covariance.matrix+1.96*covariance.matrix.se
covariance.matrix.high
covariance.matrix.low <- covariance.matrix-1.96*covariance.matrix.se
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/ICOG_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
places <- 3
covariance.matrix.new <- rep("c",25)
covariance.matrix.high <- covariance.matrix+1.96*covariance.matrix.se
covariance.matrix.low <- covariance.matrix-1.96*covariance.matrix.se
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix[i,j]-1.96*covariance.matrix.se[i,j],"-",covariance.matrix[i,j]+1.96*covariance.matrix.se[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix <- round(correlation.matrix,places)
correlation.matrix.low <- round(correlation.matrix.low,places)
correlation.matrix.high <- round(correlation.matrix.high,places)
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/ICOG_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
places <- 3
covariance.matrix.new <- rep("c",25)
covariance.matrix.high <- covariance.matrix+1.96*covariance.matrix.se
covariance.matrix.high <- round(covariance.matrix.high,places)
covariance.matrix.low <- covariance.matrix-1.96*covariance.matrix.se
covariance.matrix.low <- round(covariance.matrix.low,places)
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix.low[i,j],"-",covariance.matrix.high[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix <- round(correlation.matrix,places)
correlation.matrix.low <- round(correlation.matrix.low,places)
correlation.matrix.high <- round(correlation.matrix.high,places)
correlation.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,5,5)
write.csv(covariance.matrix.new,file="./covariance_matrix_icog.csv",quote=F)
write.csv(correlation.matrix.new,file="./correlation_matrix_icog.csv",quote=F)
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
col <- colorRampPalette(c("white", "dodgerblue4"))(50)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none")
col <- colorRampPalette(c("red", "dodgerblue4"))(50)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=col,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none")
col <- colorRampPalette(c("red","white","dodgerblue4"))(50)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none")
pal.breaks <- seq(-1,1,0.1)
col <- colorRampPalette(c("red","white","dodgerblue4"))(length(pal.breaks)-1)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none")
col <- colorRampPalette(c("dodgerblue4","white","red"))(length(pal.breaks)-1)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none")
#
# cluster.p <- as.dendrogram(hclust(d = dist(x = correlation.matrix)))
# ggdendrogram(data=cluster.p,rotate=F)
# library(ggcorrplot)
# ggcorrplot(correlation.matrix)
#
#
#
#
#
rm(list=ls())
pal.breaks <- seq(-1,1,0.01)
col <- colorRampPalette(c("dodgerblue4","white","red"))(length(pal.breaks)-1)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none")
pal.breaks <- seq(-1,1,0.01)
col <- colorRampPalette(c("dodgerblue4","white","red"))(length(pal.breaks)-1)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none")
correlation.matrix
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/ICOG_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
places <- 3
covariance.matrix.new <- rep("c",25)
covariance.matrix.high <- covariance.matrix+1.96*covariance.matrix.se
covariance.matrix.high <- round(covariance.matrix.high,places)
covariance.matrix.low <- covariance.matrix-1.96*covariance.matrix.se
covariance.matrix.low <- round(covariance.matrix.low,places)
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix.low[i,j],"-",covariance.matrix.high[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix <- round(correlation.matrix,places)
correlation.matrix.low <- round(correlation.matrix.low,places)
correlation.matrix.high <- round(correlation.matrix.high,places)
correlation.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,5,5)
write.csv(covariance.matrix.new,file="./covariance_matrix_icog.csv",quote=F)
write.csv(correlation.matrix.new,file="./correlation_matrix_icog.csv",quote=F)
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
pal.breaks <- seq(-1,1,0.01)
col <- colorRampPalette(c("dodgerblue4","white","red"))(length(pal.breaks)-1)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none")
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap ICOGs",dendrogram="row",density.info="none")
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap ICOGs",dendrogram="row",density.info="none",lwid = c(1,4))
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap ICOGs",dendrogram="row",density.info="none",lwid = c(1,5))
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap ICOGs",dendrogram="row",density.info="none",lwid = c(1.5,4))
rbind(4:3,2:1)
rbind(2:1,2:1)
rbind(2:1,4:3)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap ICOGs",dendrogram="row",density.info="none",lmat=rbind(2:1,4:3),lwid = c(1.5,4))
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap ICOGs",dendrogram="row",density.info="none",lmat=rbind(2:1,4:3),lwid = c(1.5,4))
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/ICOG_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
places <- 3
covariance.matrix.new <- rep("c",25)
covariance.matrix.high <- covariance.matrix+1.96*covariance.matrix.se
covariance.matrix.high <- round(covariance.matrix.high,places)
covariance.matrix.low <- covariance.matrix-1.96*covariance.matrix.se
covariance.matrix.low <- round(covariance.matrix.low,places)
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix.low[i,j],"-",covariance.matrix.high[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix <- round(correlation.matrix,places)
correlation.matrix.low <- round(correlation.matrix.low,places)
correlation.matrix.high <- round(correlation.matrix.high,places)
correlation.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,5,5)
write.csv(covariance.matrix.new,file="./covariance_matrix_icog.csv",quote=F)
write.csv(correlation.matrix.new,file="./correlation_matrix_icog.csv",quote=F)
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
pal.breaks <- seq(-1,1,0.01)
col <- colorRampPalette(c("dodgerblue4","white","red"))(length(pal.breaks)-1)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap ICOGs",dendrogram="row",density.info="none",lmat=rbind(2:1,4:3),lwid = c(1.5,4))
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap ICOGs",dendrogram="row",density.info="none",lwid = c(1.5,4))
#
# cluster.p <- as.dendrogram(hclust(d = dist(x = correlation.matrix)))
# ggdendrogram(data=cluster.p,rotate=F)
# library(ggcorrplot)
# ggcorrplot(correlation.matrix)
#
#
#
#
#
rm(list=ls())
setwd('/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/')
load("/Users/zhangh24/GoogleDrive/breast_cancer_data_analysis/genetic_correlation/ICOG/result/breast_cancer_ldsc/ONCO_ldsc_result.rda")
covariance.matrix <- ldsc_result[[1]]
covariance.matrix.se <- ldsc_result[[3]]
correlation.matrix <- ldsc_result[[2]]
correlation.matrix.se <- ldsc_result[[4]]
places <- 3
covariance.matrix.new <- rep("c",25)
covariance.matrix.high <- covariance.matrix+1.96*covariance.matrix.se
covariance.matrix.high <- round(covariance.matrix.high,places)
covariance.matrix.low <- covariance.matrix-1.96*covariance.matrix.se
covariance.matrix.low <- round(covariance.matrix.low,places)
temp <- 1
for(i in 1:5){
for(j in 1:5){
covariance.matrix.new[temp] <- paste0(covariance.matrix[i,j]," (",covariance.matrix.low[i,j],"-",covariance.matrix.high[i,j],")")
temp <- temp+1
}
}
covariance.matrix.new <- matrix(covariance.matrix.new,5,5)
correlation.matrix.transform <- 0.5*log((1+correlation.matrix)/(1-correlation.matrix))
correlation.matrix.se.transform <- abs(correlation.matrix.se/((1+correlation.matrix)*(1-correlation.matrix)))
correlation.matrix.transform.low <- correlation.matrix.transform-1.96*correlation.matrix.se.transform
correlation.matrix.transform.high <- correlation.matrix.transform+1.96*correlation.matrix.se.transform
correlation.matrix.low <- (exp(2*correlation.matrix.transform.low)-1)/(exp(2*correlation.matrix.transform.low)+1)
correlation.matrix.high <- (exp(2*correlation.matrix.transform.high)-1)/(exp(2*correlation.matrix.transform.high)+1)
(exp(2*correlation.matrix.transform)-1)/(exp(2*correlation.matrix.transform)+1)
correlation.matrix <- round(correlation.matrix,places)
correlation.matrix.low <- round(correlation.matrix.low,places)
correlation.matrix.high <- round(correlation.matrix.high,places)
correlation.matrix.new <- rep("c",25)
temp <- 1
for(i in 1:5){
for(j in 1:5){
correlation.matrix.new[temp] <- paste0(correlation.matrix[i,j]," (",correlation.matrix.low[i,j],"-",correlation.matrix.high[i,j],")")
temp <- temp+1
}
}
correlation.matrix.new <- matrix(correlation.matrix.new,5,5)
write.csv(covariance.matrix.new,file="./covariance_matrix_icog.csv",quote=F)
write.csv(correlation.matrix.new,file="./correlation_matrix_icog.csv",quote=F)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap OncoArray",dendrogram="row",density.info="none",lwid = c(1.5,4))
library(tidyverse)
library(reshape2)
library(ggplot2)
library(gplots)
pal.breaks <- seq(-1,1,0.01)
col <- colorRampPalette(c("dodgerblue4","white","red"))(length(pal.breaks)-1)
# heatmap(correlation.matrix,col = col,symm=T,margins=c(10,4),key.title="",key.ylab="",cexRow=1,cexCol=1)
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap OncoArray",dendrogram="row",density.info="none",lwid = c(1.5,4))
heatmap.2(correlation.matrix,tracecol=NA,cexRow=1,cexCol=1,margins=c(10,12),col = col,breaks=pal.breaks,key.ylab="",key.title = "",
main=" Genetic Correlation Heatmap",dendrogram="row",density.info="none",lwid = c(1.5,4))
